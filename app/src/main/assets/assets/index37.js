import{T as A}from"./table-paginate.js";import{p as j}from"./table-paginate2.js";import{h as V,O as T,i as q}from"./record.js";import{d as S,r as d,k as F,an as U,aq as H,ar as u,aw as o,ap as t,ax as c,au as w,as as r,a$ as E,aF as K,o as L,h as G,a7 as f,bK as D,ao as J,bS as Q,bT as W,aC as X,aD as Z}from"./index.js";import{N as $}from"./DataTable.js";import{_ as O}from"./Input.js";import{a as N}from"./Dropdown.js";import{_ as ee}from"./DatePicker.js";import{_ as te}from"./Form.js";import{_ as ae}from"./_plugin-vue_export-helper.js";import"./format-length.js";import"./Checkbox.js";import"./use-merged-state.js";import"./RadioGroup.js";import"./get-slot.js";import"./FocusDetector.js";import"./next-frame-once.js";import"./get.js";import"./ChevronRight.js";import"./use-compitable.js";import"./Icon.js";import"./TimePicker.js";const le=t("div",{class:"flex justify-between items-center w-full"},[t("h2",{class:"text-xl font-bold"},"入库上架详情")],-1),se={class:"grid grid-cols-2 gap-4"},oe=t("strong",null,"入库上架人:",-1),ne=t("strong",null,"入库上架单号:",-1),re=t("strong",null,"入库上架类型:",-1),ie=t("strong",null,"入库上架时间:",-1),de=S({__name:"dialog",props:{visible:{type:Boolean},rowData:{}},emits:["update:visible","submit","cancel"],setup(_,{emit:a}){const y=_,p=d({items:[]}),b=async l=>{var m;try{const i=await V({ID:l,type:T.Inbound});if(i.error){p.value.items=[];return}p.value.items=((m=i.data)==null?void 0:m.items)||[]}catch(i){console.error("获取详情失败:",i),p.value.items=[]}},x=[{title:"耗材子编码",key:"code"},{title:"耗材名称",key:"name"},{title:"规格型号",key:"spec"},{title:"生产厂家",key:"manufacturer"},{title:"品牌",key:"brand"},{title:"单位",key:"unit"},{title:"唯一码",key:"rfid"},{title:"批号",key:"batch"},{title:"入库上架货柜",key:"cabinet.name"},{title:"入库上架数量",key:"number"}];F(()=>y.visible,(l,m)=>{if(l&&!m&&y.rowData){const i=Number(y.rowData.id);b(i)}else l||(p.value.items=[])});const k=()=>{a("update:visible",!1),a("cancel")};return(l,m)=>{const i=E,h=K;return U(),H(h,{show:l.visible,"onUpdate:show":k,preset:"card",closable:"",style:{width:"80%",height:"45rem"}},{header:u(()=>[le]),default:u(()=>[o(i,null,{default:u(()=>[t("div",se,[t("div",null,[oe,c(" "+w(l.rowData.user.name),1)]),t("div",null,[ne,c(" "+w(l.rowData.orderNo),1)]),t("div",null,[re,c(" "+w(l.rowData.orderType==="hasOrder"?"有单入库":"无单入库"),1)]),t("div",null,[ie,c(" "+w(l.rowData.time),1)])]),o(r($),{columns:x,data:p.value.items,style:{"margin-top":"20px"},"max-height":415},null,8,["data"])]),_:1})]),_:1},8,["show"])}}});const v=_=>(X("data-v-2236ea82"),_=_(),Z(),_),ue={class:"query-area"},ce={class:"grid grid-cols-5 gap-6"},pe={class:"flex items-center"},me=v(()=>t("div",{class:"mr-2",style:{width:"5.5rem"}},"耗材名称",-1)),ve={class:"flex items-center"},_e=v(()=>t("div",{class:"mr-2",style:{width:"5.5rem"}},"耗材子编码",-1)),ye={class:"flex items-center"},he=v(()=>t("div",{class:"mr-2",style:{width:"5.5rem"}},"入库上架人",-1)),fe={class:"flex items-center"},be=v(()=>t("label",{class:"mr-2",style:{width:"5.5rem"}},"入库上架货柜",-1)),ge={class:"flex items-center"},we=v(()=>t("label",{class:"mr-2",style:{width:"5.5rem"}},"入库上架类型",-1)),De={class:"flex items-center"},xe=v(()=>t("label",{class:"mr-2",style:{width:"5.5rem"}},"入库上架单号",-1)),ke={class:"flex items-center"},Ie={class:"flex items-center"},Oe=v(()=>t("label",{class:"mr-2",style:{width:"5.5rem"}},"入库上架日期",-1)),Ne={class:"flex items-center ml-4"},Ce={class:"flex justify-end mt-18"},Te={class:"mt-2"},Se={class:"mt-4"},Ue=S({__name:"index",setup(_){const a=d({userID:null,cabinetID:null,orderNo:null,code:null,name:null,operationType:"inbound",date:null,type:null}),y=d([]),p=async()=>{try{const e=await Q();e.data&&Array.isArray(e.data)&&(y.value=e.data)}catch(e){console.error("获取用户数据失败:",e)}},b=d([]),x=async()=>{try{const e=await W();e.data&&Array.isArray(e.data)&&(b.value=e.data)}catch(e){console.error("获取货柜数据失败:",e)}};L(async()=>{await p(),await x(),g()});const k=d([{label:"有单入库",value:"hasOrder"},{label:"无单入库",value:"noOrder"}]),l=d({totalItems:100,pageSize:j,currentPage:1}),m=e=>{console.log("当前页码:",e),l.value.currentPage=e},i=d([{title:"序号",key:"index",render:(e,s)=>s+1},{title:"入库上架单号",key:"orderNo"},{title:"入库上架人",key:"user.name"},{title:"入库上架时间",key:"time"},{title:"入库上架类型",key:"orderType",render:e=>e.orderType==="hasOrder"?"有单入库":"无单入库"},{title:"入库上架总数",key:"number"},{title:"入库上架货柜",key:"cabinet.name"},{title:"操作",key:"actions",render:e=>G(f,{type:"primary",onClick:()=>B(e)},"详情")}]),h=d([]),g=async()=>{try{const e=await q({userID:a.value.userID,cabinetID:a.value.cabinetID,orderNo:a.value.orderNo,code:a.value.code,name:a.value.name,date:a.value.date?[D(a.value.date[0]).format("YYYY-MM-DD"),D(a.value.date[1]).format("YYYY-MM-DD")]:null,page:l.value.currentPage,pagesize:l.value.pageSize,type:a.value.type,operationType:T.Inbound});if(e.error){h.value=[],l.value.totalItems=0;return}console.log("接口返回 items:",e.data.items),h.value=e.data.items,l.value.totalItems=e.data.total}catch(e){console.error("获取入库记录列表失败:",e),h.value=[],l.value.totalItems=0}},P=()=>{a.value={userID:null,cabinetID:null,orderNo:null,code:null,name:null,operationType:"inbound",date:null,type:null},l.value.currentPage=1,g()},Y=()=>{const e=D().startOf("day");a.value.date=[e.valueOf(),e.valueOf()]},z=()=>{const e=D().subtract(1,"day").startOf("day");a.value.date=[e.valueOf(),e.valueOf()]},R=e=>{const s=new Date().setHours(0,0,0,0);return e>s},I=d(!1),C=d({}),B=e=>{C.value=e,I.value=!0},M=()=>{g()};return(e,s)=>(U(),J("div",null,[t("div",ue,[o(r(te),{model:a.value,"label-width":100,"label-placement":"left",inline:""},{default:u(()=>[t("div",ce,[t("div",pe,[me,o(r(O),{value:a.value.name,"onUpdate:value":s[0]||(s[0]=n=>a.value.name=n),placeholder:"请输入耗材名称",style:{width:"180px"}},null,8,["value"])]),t("div",ve,[_e,o(r(O),{value:a.value.code,"onUpdate:value":s[1]||(s[1]=n=>a.value.code=n),placeholder:"请输入耗材子编码",style:{width:"180px"}},null,8,["value"])]),t("div",ye,[he,o(r(N),{value:a.value.userID,"onUpdate:value":s[2]||(s[2]=n=>a.value.userID=n),options:y.value,placeholder:"请选择入库上架人","virtual-scroll":"",style:{width:"180px"},"dropdown-style":{maxHeight:"300px",width:"200px"}},null,8,["value","options"])]),t("div",fe,[be,o(r(N),{value:a.value.cabinetID,"onUpdate:value":s[3]||(s[3]=n=>a.value.cabinetID=n),options:b.value,placeholder:"请选择",style:{width:"180px"},clearable:""},null,8,["value","options"])]),t("div",ge,[we,o(r(N),{value:a.value.type,"onUpdate:value":s[4]||(s[4]=n=>a.value.type=n),options:k.value,placeholder:"请选择",style:{width:"180px"},clearable:""},null,8,["value","options"])]),t("div",De,[xe,o(r(O),{value:a.value.orderNo,"onUpdate:value":s[5]||(s[5]=n=>a.value.orderNo=n),placeholder:"请输入",style:{width:"180px"}},null,8,["value"])]),t("div",ke,[t("div",Ie,[Oe,o(r(ee),{value:a.value.date,"onUpdate:value":s[6]||(s[6]=n=>a.value.date=n),type:"daterange",placeholder:"请选择日期范围","disabled-date":R,style:{width:"265px"}},null,8,["value"])]),t("div",Ne,[o(r(f),{type:"primary",style:{"margin-left":"20px"},onClick:Y},{default:u(()=>[c("今日")]),_:1}),o(r(f),{type:"primary",style:{"margin-left":"15px"},onClick:z},{default:u(()=>[c("昨日")]),_:1})])])]),t("div",Ce,[o(r(f),{type:"primary",onClick:g},{default:u(()=>[c("查询")]),_:1}),o(r(f),{type:"primary",style:{"margin-left":"8px"},onClick:P},{default:u(()=>[c("重置")]),_:1})])]),_:1},8,["model"])]),t("div",Te,[o(r(f),{type:"primary",onClick:M},{default:u(()=>[c("刷新")]),_:1})]),t("div",Se,[o(r($),{columns:i.value,data:h.value},null,8,["columns","data"])]),o(A,{total:l.value.totalItems,"page-size":l.value.pageSize,"current-page":l.value.currentPage,onPageChange:m},null,8,["total","page-size","current-page"]),o(de,{visible:I.value,"onUpdate:visible":s[7]||(s[7]=n=>I.value=n),rowData:C.value},null,8,["visible","rowData"])]))}});const et=ae(Ue,[["__scopeId","data-v-2236ea82"]]);export{et as default};
