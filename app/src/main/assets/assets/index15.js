import{d as ue,h as y,bC as _t,f as Ct,bV as Jn,bW as St,bX as Rt,B as et,E as Ze,ag as Nt,ah as Kt,N as Dt,r as S,bY as Tn,l as E,D as At,bZ as re,o as nt,b_ as Tt,ac as tt,b$ as Ft,c as j,a as ke,j as ne,c0 as Hn,b as Oe,ab as Qe,aa as It,u as at,by as Pt,n as kn,w as rn,t as $,k as Ve,A as lt,c1 as Fn,ad as dn,q as ot,c2 as Gn,x as it,y as In,a6 as q,i as Lt,a0 as Et,s as Ot,T as Bt,a4 as $t,a5 as Ut,af as Mt,a3 as jt,c3 as zt,an as ce,ao as Fe,ap as D,bb as xn,aq as sn,ar as z,aw as I,ax as Ae,a7 as _e,a$ as cn,aF as wn,c4 as Vt,c5 as Ht,au as Ie,aB as qn,bI as rt,as as le,c6 as Gt,bh as qt,c7 as Wn,c8 as Wt,c9 as Xt,ca as Yt,az as Qt,cb as Zt,aC as Jt,aD as ea}from"./index.js";import{_ as Ln}from"./Checkbox.js";import{h as En,u as On,V as na,a as ta,b as aa,F as la}from"./FocusDetector.js";import{c as dt,d as oa,V as ia,f as Xn,e as st,u as ra,g as da,a as sa}from"./Dropdown.js";import{u as He}from"./use-merged-state.js";import{u as ca,_ as pn}from"./Input.js";import{N as ct}from"./DataTable.js";import{N as yn}from"./Icon.js";import{_ as ua}from"./_plugin-vue_export-helper.js";import"./next-frame-once.js";import"./use-compitable.js";import"./get.js";import"./format-length.js";import"./ChevronRight.js";import"./RadioGroup.js";import"./get-slot.js";function ut(e){return typeof e=="string"?`s-${e}`:`n-${e}`}const fa=ue({name:"Switcher",render(){return y("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},y("path",{d:"M12 8l10 8l-10 8z"}))}}),ha=e=>{const{popoverColor:t,boxShadow2:r,borderRadius:s,heightMedium:i,dividerColor:d,textColor2:x}=e;return{menuPadding:"4px",menuColor:t,menuBoxShadow:r,menuBorderRadius:s,menuHeight:`calc(${i} * 7.6)`,actionDividerColor:d,actionTextColor:x,actionPadding:"8px 12px"}},va=_t({name:"TreeSelect",common:Ct,peers:{Tree:Jn,Empty:St,InternalSelection:Rt},self:ha}),ga=va,Bn=et("n-tree-select"),un=et("n-tree"),ma=ue({name:"NTreeSwitcher",props:{clsPrefix:{type:String,required:!0},indent:{type:Number,required:!0},expanded:Boolean,selected:Boolean,hide:Boolean,loading:Boolean,onClick:Function,tmNode:{type:Object,required:!0}},setup(e){const{renderSwitcherIconRef:t}=Ze(un,null);return()=>{const{clsPrefix:r,expanded:s,hide:i,indent:d,onClick:x}=e;return y("span",{"data-switcher":!0,class:[`${r}-tree-node-switcher`,s&&`${r}-tree-node-switcher--expanded`,i&&`${r}-tree-node-switcher--hide`],style:{width:`${d}px`},onClick:x},y("div",{class:`${r}-tree-node-switcher__icon`},y(Nt,null,{default:()=>{if(e.loading)return y(Kt,{clsPrefix:r,key:"loading",radius:85,strokeWidth:20});const{value:b}=t;return b?b({expanded:e.expanded,selected:e.selected,option:e.tmNode.rawNode}):y(Dt,{clsPrefix:r,key:"switcher"},{default:()=>y(fa,null)})}})))}}}),ya=ue({name:"NTreeNodeCheckbox",props:{clsPrefix:{type:String,required:!0},indent:{type:Number,required:!0},right:Boolean,focusable:Boolean,disabled:Boolean,checked:Boolean,indeterminate:Boolean,onCheck:Function},setup(e){const t=Ze(un);function r(i){const{onCheck:d}=e;d&&d(i)}function s(i){r(i)}return{handleUpdateValue:s,mergedTheme:t.mergedThemeRef}},render(){const{clsPrefix:e,mergedTheme:t,checked:r,indeterminate:s,disabled:i,focusable:d,indent:x,handleUpdateValue:b}=this;return y("span",{class:[`${e}-tree-node-checkbox`,this.right&&`${e}-tree-node-checkbox--right`],style:{width:`${x}px`},"data-checkbox":!0},y(Ln,{focusable:d,disabled:i,theme:t.peers.Checkbox,themeOverrides:t.peerOverrides.Checkbox,checked:r,indeterminate:s,onUpdateChecked:b}))}}),ba=ue({name:"TreeNodeContent",props:{clsPrefix:{type:String,required:!0},disabled:Boolean,checked:Boolean,selected:Boolean,onClick:Function,onDragstart:Function,tmNode:{type:Object,required:!0},nodeProps:Object},setup(e){const{renderLabelRef:t,renderPrefixRef:r,renderSuffixRef:s,labelFieldRef:i}=Ze(un),d=S(null);function x(p){const{onClick:_}=e;_&&_(p)}function b(p){x(p)}return{selfRef:d,renderLabel:t,renderPrefix:r,renderSuffix:s,labelField:i,handleClick:b}},render(){const{clsPrefix:e,labelField:t,nodeProps:r,checked:s=!1,selected:i=!1,renderLabel:d,renderPrefix:x,renderSuffix:b,handleClick:p,onDragstart:_,tmNode:{rawNode:o,rawNode:{prefix:h,suffix:c,[t]:f}}}=this;return y("span",Object.assign({},r,{ref:"selfRef",class:[`${e}-tree-node-content`,r==null?void 0:r.class],onClick:p,draggable:_===void 0?void 0:!0,onDragstart:_}),x||h?y("div",{class:`${e}-tree-node-content__prefix`},x?x({option:o,selected:i,checked:s}):Tn(h)):null,y("div",{class:`${e}-tree-node-content__text`},d?d({option:o,selected:i,checked:s}):Tn(f)),b||c?y("div",{class:`${e}-tree-node-content__suffix`},b?b({option:o,selected:i,checked:s}):Tn(c)):null)}});function Yn({position:e,offsetLevel:t,indent:r,el:s}){const i={position:"absolute",boxSizing:"border-box",right:0};if(e==="inside")i.left=0,i.top=0,i.bottom=0,i.borderRadius="inherit",i.boxShadow="inset 0 0 0 2px var(--n-drop-mark-color)";else{const d=e==="before"?"top":"bottom";i[d]=0,i.left=`${s.offsetLeft+6-t*r}px`,i.height="2px",i.backgroundColor="var(--n-drop-mark-color)",i.transformOrigin=d,i.borderRadius="1px",i.transform=e==="before"?"translateY(-4px)":"translateY(4px)"}return y("div",{style:i})}function pa({dropPosition:e,node:t}){return t.isLeaf===!1||t.children?!0:e!=="inside"}function ft(e){return E(()=>e.leafOnly?"child":e.checkStrategy)}function Ee(e,t){return!!e.rawNode[t]}function ht(e,t,r,s){e==null||e.forEach(i=>{r(i),ht(i[t],t,r,s),s(i)})}function ka(e,t,r,s,i){const d=new Set,x=new Set,b=[];return ht(e,s,p=>{if(b.push(p),i(t,p)){x.add(p[r]);for(let _=b.length-2;_>=0;--_)if(!d.has(b[_][r]))d.add(b[_][r]);else return}},()=>{b.pop()}),{expandedKeys:Array.from(d),highlightKeySet:x}}if(At&&Image){const e=new Image;e.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="}function xa(e,t,r,s,i){const d=new Set,x=new Set,b=new Set,p=[],_=[],o=[];function h(f){f.forEach(R=>{if(o.push(R),t(r,R)){d.add(R[s]),b.add(R[s]);for(let T=o.length-2;T>=0;--T){const F=o[T][s];if(!x.has(F))x.add(F),d.has(F)&&d.delete(F);else break}}const A=R[i];A&&h(A),o.pop()})}h(e);function c(f,R){f.forEach(A=>{const T=A[s],F=d.has(T),Y=x.has(T);if(!F&&!Y)return;const U=A[i];if(U)if(F)R.push(A);else{p.push(T);const G=Object.assign(Object.assign({},A),{[i]:[]});R.push(G),c(U,G[i])}else R.push(A)})}return c(e,_),{filteredTree:_,highlightKeySet:b,expandedKeys:p}}const wa=ue({name:"TreeNode",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0}},setup(e){const t=Ze(un),{droppingNodeParentRef:r,droppingMouseNodeRef:s,draggingNodeRef:i,droppingPositionRef:d,droppingOffsetLevelRef:x,nodePropsRef:b,indentRef:p,blockLineRef:_,checkboxPlacementRef:o,checkOnClickRef:h,disabledFieldRef:c,showLineRef:f}=t,R=re(()=>!!e.tmNode.rawNode.checkboxDisabled),A=re(()=>Ee(e.tmNode,c.value)),T=re(()=>t.disabledRef.value||A.value),F=E(()=>{const{value:g}=b;if(g)return g({option:e.tmNode.rawNode})}),Y=S(null),U={value:null};nt(()=>{U.value=Y.value.$el});function G(){const{tmNode:g}=e;if(!g.isLeaf&&!g.shallowLoaded){if(!t.loadingKeysRef.value.has(g.key))t.loadingKeysRef.value.add(g.key);else return;const{onLoadRef:{value:P}}=t;P&&P(g.rawNode).then(L=>{L!==!1&&t.handleSwitcherClick(g)}).finally(()=>{t.loadingKeysRef.value.delete(g.key)})}else t.handleSwitcherClick(g)}const Q=re(()=>!A.value&&t.selectableRef.value&&(t.internalTreeSelect?t.mergedCheckStrategyRef.value!=="child"||t.multipleRef.value&&t.cascadeRef.value||e.tmNode.isLeaf:!0)),Z=re(()=>t.checkableRef.value&&(t.cascadeRef.value||t.mergedCheckStrategyRef.value!=="child"||e.tmNode.isLeaf)),Ce=re(()=>t.displayedCheckedKeysRef.value.includes(e.tmNode.key)),J=re(()=>{const{value:g}=Z;if(!g)return!1;const{value:P}=h,{tmNode:L}=e;return typeof P=="boolean"?!L.disabled&&P:P(e.tmNode.rawNode)});function xe(g){const{value:P}=t.expandOnClickRef,{value:L}=Q,{value:te}=J;if(!L&&!P&&!te||En(g,"checkbox")||En(g,"switcher"))return;const{tmNode:Be}=e;L&&t.handleSelect(Be),P&&!Be.isLeaf&&G(),te&&Se(!Ce.value)}function oe(g){var P,L;_.value||(T.value||xe(g),(L=(P=F.value)===null||P===void 0?void 0:P.onClick)===null||L===void 0||L.call(P,g))}function me(g){var P,L;_.value&&(T.value||xe(g),(L=(P=F.value)===null||P===void 0?void 0:P.onClick)===null||L===void 0||L.call(P,g))}function Se(g){t.handleCheck(e.tmNode,g)}function Te(g){t.handleDragStart({event:g,node:e.tmNode})}function k(g){g.currentTarget===g.target&&t.handleDragEnter({event:g,node:e.tmNode})}function m(g){g.preventDefault(),t.handleDragOver({event:g,node:e.tmNode})}function W(g){t.handleDragEnd({event:g,node:e.tmNode})}function V(g){g.currentTarget===g.target&&t.handleDragLeave({event:g,node:e.tmNode})}function ee(g){g.preventDefault(),d.value!==null&&t.handleDrop({event:g,node:e.tmNode,dropPosition:d.value})}const de=E(()=>{const{clsPrefix:g}=e,{value:P}=p;if(f.value){const L=[];let te=e.tmNode.parent;for(;te;)te.isLastChild?L.push(y("div",{class:`${g}-tree-node-indent`},y("div",{style:{width:`${P}px`}}))):L.push(y("div",{class:[`${g}-tree-node-indent`,`${g}-tree-node-indent--show-line`]},y("div",{style:{width:`${P}px`}}))),te=te.parent;return L.reverse()}else return Tt(e.tmNode.level,y("div",{class:`${e.clsPrefix}-tree-node-indent`},y("div",{style:{width:`${P}px`}})))});return{showDropMark:re(()=>{const{value:g}=i;if(!g)return;const{value:P}=d;if(!P)return;const{value:L}=s;if(!L)return;const{tmNode:te}=e;return te.key===L.key}),showDropMarkAsParent:re(()=>{const{value:g}=r;if(!g)return!1;const{tmNode:P}=e,{value:L}=d;return L==="before"||L==="after"?g.key===P.key:!1}),pending:re(()=>t.pendingNodeKeyRef.value===e.tmNode.key),loading:re(()=>t.loadingKeysRef.value.has(e.tmNode.key)),highlight:re(()=>{var g;return(g=t.highlightKeySetRef.value)===null||g===void 0?void 0:g.has(e.tmNode.key)}),checked:Ce,indeterminate:re(()=>t.displayedIndeterminateKeysRef.value.includes(e.tmNode.key)),selected:re(()=>t.mergedSelectedKeysRef.value.includes(e.tmNode.key)),expanded:re(()=>t.mergedExpandedKeysRef.value.includes(e.tmNode.key)),disabled:T,checkable:Z,mergedCheckOnClick:J,checkboxDisabled:R,selectable:Q,expandOnClick:t.expandOnClickRef,internalScrollable:t.internalScrollableRef,draggable:t.draggableRef,blockLine:_,nodeProps:F,checkboxFocusable:t.internalCheckboxFocusableRef,droppingPosition:d,droppingOffsetLevel:x,indent:p,checkboxPlacement:o,showLine:f,contentInstRef:Y,contentElRef:U,indentNodes:de,handleCheck:Se,handleDrop:ee,handleDragStart:Te,handleDragEnter:k,handleDragOver:m,handleDragEnd:W,handleDragLeave:V,handleLineClick:me,handleContentClick:oe,handleSwitcherClick:G}},render(){const{tmNode:e,clsPrefix:t,checkable:r,expandOnClick:s,selectable:i,selected:d,checked:x,highlight:b,draggable:p,blockLine:_,indent:o,indentNodes:h,disabled:c,pending:f,internalScrollable:R,nodeProps:A,checkboxPlacement:T}=this,F=p&&!c?{onDragenter:this.handleDragEnter,onDragleave:this.handleDragLeave,onDragend:this.handleDragEnd,onDrop:this.handleDrop,onDragover:this.handleDragOver}:void 0,Y=R?ut(e.key):void 0,U=T==="right",G=r?y(ya,{indent:o,right:U,focusable:this.checkboxFocusable,disabled:c||this.checkboxDisabled,clsPrefix:t,checked:this.checked,indeterminate:this.indeterminate,onCheck:this.handleCheck}):null;return y("div",Object.assign({class:`${t}-tree-node-wrapper`},F),y("div",Object.assign({},_?A:void 0,{class:[`${t}-tree-node`,{[`${t}-tree-node--selected`]:d,[`${t}-tree-node--checkable`]:r,[`${t}-tree-node--highlight`]:b,[`${t}-tree-node--pending`]:f,[`${t}-tree-node--disabled`]:c,[`${t}-tree-node--selectable`]:i,[`${t}-tree-node--clickable`]:i||s||this.mergedCheckOnClick},A==null?void 0:A.class],"data-key":Y,draggable:p&&_,onClick:this.handleLineClick,onDragstart:p&&_&&!c?this.handleDragStart:void 0}),h,e.isLeaf&&this.showLine?y("div",{class:[`${t}-tree-node-indent`,`${t}-tree-node-indent--show-line`,e.isLeaf&&`${t}-tree-node-indent--is-leaf`,e.isLastChild&&`${t}-tree-node-indent--last-child`]},y("div",{style:{width:`${o}px`}})):y(ma,{clsPrefix:t,expanded:this.expanded,selected:d,loading:this.loading,hide:e.isLeaf,tmNode:this.tmNode,indent:o,onClick:this.handleSwitcherClick}),U?null:G,y(ba,{ref:"contentInstRef",clsPrefix:t,checked:x,selected:d,onClick:this.handleContentClick,nodeProps:_?void 0:A,onDragstart:p&&!_&&!c?this.handleDragStart:void 0,tmNode:e}),p?this.showDropMark?Yn({el:this.contentElRef.value,position:this.droppingPosition,offsetLevel:this.droppingOffsetLevel,indent:o}):this.showDropMarkAsParent?Yn({el:this.contentElRef.value,position:"inside",offsetLevel:this.droppingOffsetLevel,indent:o}):null:null,U?G:null))}}),vt=wa;function _a({props:e,fNodesRef:t,mergedExpandedKeysRef:r,mergedSelectedKeysRef:s,handleSelect:i,handleSwitcherClick:d}){const{value:x}=s,b=Ze(Bn,null),p=b?b.pendingNodeKeyRef:S(x.length?x[x.length-1]:null);function _(o){if(!e.keyboard)return;const{value:h}=p;if(h===null){if((o.key==="ArrowDown"||o.key==="ArrowUp")&&o.preventDefault(),["ArrowDown","ArrowUp","ArrowLeft","ArrowRight"].includes(o.key)&&h===null){const{value:c}=t;let f=0;for(;f<c.length;){if(!c[f].disabled){p.value=c[f].key;break}f+=1}}}else{const{value:c}=t;let f=c.findIndex(R=>R.key===h);if(!~f)return;if(o.key==="Enter")i(c[f]);else if(o.key==="ArrowDown")for(o.preventDefault(),f+=1;f<c.length;){if(!c[f].disabled){p.value=c[f].key;break}f+=1}else if(o.key==="ArrowUp")for(o.preventDefault(),f-=1;f>=0;){if(!c[f].disabled){p.value=c[f].key;break}f-=1}else if(o.key==="ArrowLeft"){const R=c[f];if(R.isLeaf||!r.value.includes(h)){const A=R.getParent();A&&(p.value=A.key)}else d(R)}else if(o.key==="ArrowRight"){const R=c[f];if(R.isLeaf)return;if(!r.value.includes(h))d(R);else for(f+=1;f<c.length;){if(!c[f].disabled){p.value=c[f].key;break}f+=1}}}}return{pendingNodeKeyRef:p,handleKeydown:_}}const Ca=ue({name:"TreeMotionWrapper",props:{clsPrefix:{type:String,required:!0},height:Number,nodes:{type:Array,required:!0},mode:{type:String,required:!0},onAfterEnter:{type:Function,required:!0}},render(){const{clsPrefix:e}=this;return y(Ft,{onAfterEnter:this.onAfterEnter,appear:!0,reverse:this.mode==="collapse"},{default:()=>y("div",{class:[`${e}-tree-motion-wrapper`,`${e}-tree-motion-wrapper--${this.mode}`],style:{height:tt(this.height)}},this.nodes.map(t=>y(vt,{clsPrefix:e,tmNode:t})))})}}),Pn=It(),Sa=j("tree",`
 font-size: var(--n-font-size);
 outline: none;
`,[ke("ul, li",`
 margin: 0;
 padding: 0;
 list-style: none;
 `),ke(">",[j("tree-node",[ke("&:first-child","margin-top: 0;")])]),j("tree-motion-wrapper",[ne("expand",[Hn({duration:"0.2s"})]),ne("collapse",[Hn({duration:"0.2s",reverse:!0})])]),j("tree-node-wrapper",`
 box-sizing: border-box;
 padding: var(--n-node-wrapper-padding);
 `),j("tree-node",`
 transform: translate3d(0,0,0);
 position: relative;
 display: flex;
 border-radius: var(--n-node-border-radius);
 transition: background-color .3s var(--n-bezier);
 `,[ne("highlight",[j("tree-node-content",[Oe("text","border-bottom-color: var(--n-node-text-color-disabled);")])]),ne("disabled",[j("tree-node-content",`
 color: var(--n-node-text-color-disabled);
 cursor: not-allowed;
 `)]),Qe("disabled",[ne("clickable",[j("tree-node-content",`
 cursor: pointer;
 `)])])]),ne("block-node",[j("tree-node-content",`
 flex: 1;
 min-width: 0;
 `)]),Qe("block-line",[j("tree-node",[Qe("disabled",[j("tree-node-content",[ke("&:hover","background: var(--n-node-color-hover);")]),ne("selectable",[j("tree-node-content",[ke("&:active","background: var(--n-node-color-pressed);")])]),ne("pending",[j("tree-node-content",`
 background: var(--n-node-color-hover);
 `)]),ne("selected",[j("tree-node-content","background: var(--n-node-color-active);")])])])]),ne("block-line",[j("tree-node",[Qe("disabled",[ke("&:hover","background: var(--n-node-color-hover);"),ne("pending",`
 background: var(--n-node-color-hover);
 `),ne("selectable",[Qe("selected",[ke("&:active","background: var(--n-node-color-pressed);")])]),ne("selected","background: var(--n-node-color-active);")]),ne("disabled",`
 cursor: not-allowed;
 `)])]),j("tree-node-indent",`
 flex-grow: 0;
 flex-shrink: 0;
 `,[ne("show-line","position: relative",[ke("&::before",`
 position: absolute;
 left: 50%;
 border-left: 1px solid var(--n-border-color);
 transition: border-color .3s var(--n-bezier);
 transform: translate(-50%);
 content: "";
 top: var(--n-line-offset-top);
 bottom: var(--n-line-offset-bottom);
 `),ne("last-child",[ke("&::before",`
 bottom: 50%;
 `)]),ne("is-leaf",[ke("&::after",`
 position: absolute;
 content: "";
 left: calc(50% + 0.5px);
 right: 0;
 bottom: 50%;
 transition: border-color .3s var(--n-bezier);
 border-bottom: 1px solid var(--n-border-color);
 `)])]),Qe("show-line","height: 0;")]),j("tree-node-switcher",`
 cursor: pointer;
 display: inline-flex;
 flex-shrink: 0;
 height: var(--n-node-content-height);
 align-items: center;
 justify-content: center;
 transition: transform .15s var(--n-bezier);
 vertical-align: bottom;
 `,[Oe("icon",`
 position: relative;
 height: 14px;
 width: 14px;
 display: flex;
 color: var(--n-arrow-color);
 transition: color .3s var(--n-bezier);
 font-size: 14px;
 `,[j("icon",[Pn]),j("base-loading",`
 color: var(--n-loading-color);
 position: absolute;
 left: 0;
 top: 0;
 right: 0;
 bottom: 0;
 `,[Pn]),j("base-icon",[Pn])]),ne("hide","visibility: hidden;"),ne("expanded","transform: rotate(90deg);")]),j("tree-node-checkbox",`
 display: inline-flex;
 height: var(--n-node-content-height);
 vertical-align: bottom;
 align-items: center;
 justify-content: center;
 `),j("tree-node-content",`
 user-select: none;
 position: relative;
 display: inline-flex;
 align-items: center;
 min-height: var(--n-node-content-height);
 box-sizing: border-box;
 line-height: var(--n-line-height);
 vertical-align: bottom;
 padding: 0 6px 0 4px;
 cursor: default;
 border-radius: var(--n-node-border-radius);
 color: var(--n-node-text-color);
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `,[ke("&:last-child","margin-bottom: 0;"),Oe("prefix",`
 display: inline-flex;
 margin-right: 8px;
 `),Oe("text",`
 border-bottom: 1px solid #0000;
 transition: border-color .3s var(--n-bezier);
 flex-grow: 1;
 max-width: 100%;
 `),Oe("suffix",`
 display: inline-flex;
 `)]),Oe("empty","margin: auto;")]);var Ra=globalThis&&globalThis.__awaiter||function(e,t,r,s){function i(d){return d instanceof r?d:new r(function(x){x(d)})}return new(r||(r=Promise))(function(d,x){function b(o){try{_(s.next(o))}catch(h){x(h)}}function p(o){try{_(s.throw(o))}catch(h){x(h)}}function _(o){o.done?d(o.value):i(o.value).then(b,p)}_((s=s.apply(e,t||[])).next())})};function gt(e,t,r,s){return{getIsGroup(){return!1},getKey(d){return d[e]},getChildren:s||(d=>d[t]),getDisabled(d){return!!(d[r]||d.checkboxDisabled)}}}const mt={allowCheckingNotLoaded:Boolean,filter:Function,defaultExpandAll:Boolean,expandedKeys:Array,keyField:{type:String,default:"key"},labelField:{type:String,default:"label"},childrenField:{type:String,default:"children"},disabledField:{type:String,default:"disabled"},defaultExpandedKeys:{type:Array,default:()=>[]},indeterminateKeys:Array,renderSwitcherIcon:Function,onUpdateIndeterminateKeys:[Function,Array],"onUpdate:indeterminateKeys":[Function,Array],onUpdateExpandedKeys:[Function,Array],"onUpdate:expandedKeys":[Function,Array]},Na=Object.assign(Object.assign(Object.assign(Object.assign({},kn.props),{accordion:Boolean,showIrrelevantNodes:{type:Boolean,default:!0},data:{type:Array,default:()=>[]},expandOnDragenter:{type:Boolean,default:!0},expandOnClick:Boolean,checkOnClick:{type:[Boolean,Function],default:!1},cancelable:{type:Boolean,default:!0},checkable:Boolean,draggable:Boolean,blockNode:Boolean,blockLine:Boolean,showLine:Boolean,disabled:Boolean,checkedKeys:Array,defaultCheckedKeys:{type:Array,default:()=>[]},selectedKeys:Array,defaultSelectedKeys:{type:Array,default:()=>[]},multiple:Boolean,pattern:{type:String,default:""},onLoad:Function,cascade:Boolean,selectable:{type:Boolean,default:!0},scrollbarProps:Object,indent:{type:Number,default:24},allowDrop:{type:Function,default:pa},animated:{type:Boolean,default:!0},checkboxPlacement:{type:String,default:"left"},virtualScroll:Boolean,watchProps:Array,renderLabel:Function,renderPrefix:Function,renderSuffix:Function,nodeProps:Function,keyboard:{type:Boolean,default:!0},getChildren:Function,onDragenter:[Function,Array],onDragleave:[Function,Array],onDragend:[Function,Array],onDragstart:[Function,Array],onDragover:[Function,Array],onDrop:[Function,Array],onUpdateCheckedKeys:[Function,Array],"onUpdate:checkedKeys":[Function,Array],onUpdateSelectedKeys:[Function,Array],"onUpdate:selectedKeys":[Function,Array]}),mt),{internalTreeSelect:Boolean,internalScrollable:Boolean,internalScrollablePadding:String,internalRenderEmpty:Function,internalHighlightKeySet:Object,internalUnifySelectCheck:Boolean,internalCheckboxFocusable:{type:Boolean,default:!0},internalFocusable:{type:Boolean,default:!0},checkStrategy:{type:String,default:"all"},leafOnly:Boolean}),Ka=ue({name:"Tree",props:Na,setup(e){const{mergedClsPrefixRef:t,inlineThemeDisabled:r,mergedRtlRef:s}=at(e),i=Pt("Tree",s,t),d=kn("Tree","-tree",Sa,Jn,e,t),x=S(null),b=S(null),p=S(null);function _(){var n;return(n=p.value)===null||n===void 0?void 0:n.listElRef}function o(){var n;return(n=p.value)===null||n===void 0?void 0:n.itemsElRef}const h=E(()=>{const{filter:n}=e;if(n)return n;const{labelField:l}=e;return(u,C)=>{if(!u.length)return!0;const w=C[l];return typeof w=="string"?w.toLowerCase().includes(u.toLowerCase()):!1}}),c=E(()=>{const{pattern:n}=e;return n?!n.length||!h.value?{filteredTree:e.data,highlightKeySet:null,expandedKeys:void 0}:xa(e.data,h.value,n,e.keyField,e.childrenField):{filteredTree:e.data,highlightKeySet:null,expandedKeys:void 0}}),f=E(()=>dt(e.showIrrelevantNodes?e.data:c.value.filteredTree,gt(e.keyField,e.childrenField,e.disabledField,e.getChildren))),R=Ze(Bn,null),A=e.internalTreeSelect?R.dataTreeMate:f,{watchProps:T}=e,F=S([]);T!=null&&T.includes("defaultCheckedKeys")?rn(()=>{F.value=e.defaultCheckedKeys}):F.value=e.defaultCheckedKeys;const Y=$(e,"checkedKeys"),U=He(Y,F),G=E(()=>A.value.getCheckedKeys(U.value,{cascade:e.cascade,allowNotLoaded:e.allowCheckingNotLoaded})),Q=ft(e),Z=E(()=>G.value.checkedKeys),Ce=E(()=>{const{indeterminateKeys:n}=e;return n!==void 0?n:G.value.indeterminateKeys}),J=S([]);T!=null&&T.includes("defaultSelectedKeys")?rn(()=>{J.value=e.defaultSelectedKeys}):J.value=e.defaultSelectedKeys;const xe=$(e,"selectedKeys"),oe=He(xe,J),me=S([]),Se=n=>{me.value=e.defaultExpandAll?A.value.getNonLeafKeys():n===void 0?e.defaultExpandedKeys:n};T!=null&&T.includes("defaultExpandedKeys")?rn(()=>{Se(void 0)}):rn(()=>{Se(e.defaultExpandedKeys)});const Te=$(e,"expandedKeys"),k=He(Te,me),m=E(()=>f.value.getFlattenedNodes(k.value)),{pendingNodeKeyRef:W,handleKeydown:V}=_a({props:e,mergedSelectedKeysRef:oe,fNodesRef:m,mergedExpandedKeysRef:k,handleSelect:N,handleSwitcherClick:K});let ee=null,de=null;const g=S(new Set),P=E(()=>e.internalHighlightKeySet||c.value.highlightKeySet),L=He(P,g),te=S(new Set),Be=E(()=>k.value.filter(n=>!te.value.has(n)));let Re=0;const $e=S(null),Ge=S(null),Ue=S(null),Me=S(null),fe=S(0),Je=E(()=>{const{value:n}=Ge;return n?n.parent:null});Ve($(e,"data"),()=>{te.value.clear(),W.value=null,ze()},{deep:!1});let en=!1;const nn=()=>{en=!0,In(()=>{en=!1})};let je;Ve($(e,"pattern"),(n,l)=>{if(e.showIrrelevantNodes)if(je=void 0,n){const{expandedKeys:u,highlightKeySet:C}=ka(e.data,e.pattern,e.keyField,e.childrenField,h.value);g.value=C,nn(),Le(u,ie(u),{node:null,action:"filter"})}else g.value=new Set;else if(!n.length)je!==void 0&&(nn(),Le(je,ie(je),{node:null,action:"filter"}));else{l.length||(je=k.value);const{expandedKeys:u}=c.value;u!==void 0&&(nn(),Le(u,ie(u),{node:null,action:"filter"}))}});function Ne(n){return Ra(this,void 0,void 0,function*(){const{onLoad:l}=e;if(!l){yield Promise.resolve();return}const{value:u}=te;if(!u.has(n.key)){u.add(n.key);try{(yield l(n.rawNode))===!1&&he()}catch(C){console.error(C),he()}u.delete(n.key)}})}rn(()=>{var n;const{value:l}=f;if(!l)return;const{getNode:u}=l;(n=k.value)===null||n===void 0||n.forEach(C=>{const w=u(C);w&&!w.shallowLoaded&&Ne(w)})});const Pe=S(!1),Ke=S([]);Ve(Be,(n,l)=>{if(!e.animated||en){In(qe);return}const u=dn(d.value.self.nodeHeight),C=new Set(l);let w=null,H=null;for(const M of n)if(!C.has(M)){if(w!==null)return;w=M}const se=new Set(n);for(const M of l)if(!se.has(M)){if(H!==null)return;H=M}if(w===null&&H===null)return;const{virtualScroll:ge}=e,Xe=(ge?p.value.listElRef:x.value).offsetHeight,Ye=Math.ceil(Xe/u)+1;let be;if(w!==null&&(be=l),H!==null&&(be===void 0?be=n:be=be.filter(M=>M!==H)),Pe.value=!0,Ke.value=f.value.getFlattenedNodes(be),w!==null){const M=Ke.value.findIndex(pe=>pe.key===w);if(~M){const pe=Ke.value[M].children;if(pe){const we=Xn(pe,n);Ke.value.splice(M+1,0,{__motion:!0,mode:"expand",height:ge?we.length*u:void 0,nodes:ge?we.slice(0,Ye):we})}}}if(H!==null){const M=Ke.value.findIndex(pe=>pe.key===H);if(~M){const pe=Ke.value[M].children;if(!pe)return;Pe.value=!0;const we=Xn(pe,n);Ke.value.splice(M+1,0,{__motion:!0,mode:"collapse",height:ge?we.length*u:void 0,nodes:ge?we.slice(0,Ye):we})}}});const _n=E(()=>oa(m.value)),Cn=E(()=>Pe.value?Ke.value:m.value);function qe(){const{value:n}=b;n&&n.sync()}function Sn(){Pe.value=!1,e.virtualScroll&&In(qe)}function ie(n){const{getNode:l}=A.value;return n.map(u=>{var C;return((C=l(u))===null||C===void 0?void 0:C.rawNode)||null})}function Le(n,l,u){const{"onUpdate:expandedKeys":C,onUpdateExpandedKeys:w}=e;me.value=n,C&&q(C,n,l,u),w&&q(w,n,l,u)}function fn(n,l,u){const{"onUpdate:checkedKeys":C,onUpdateCheckedKeys:w}=e;F.value=n,w&&q(w,n,l,u),C&&q(C,n,l,u)}function hn(n,l){const{"onUpdate:indeterminateKeys":u,onUpdateIndeterminateKeys:C}=e;u&&q(u,n,l),C&&q(C,n,l)}function tn(n,l,u){const{"onUpdate:selectedKeys":C,onUpdateSelectedKeys:w}=e;J.value=n,w&&q(w,n,l,u),C&&q(C,n,l,u)}function Rn(n){const{onDragenter:l}=e;l&&q(l,n)}function Nn(n){const{onDragleave:l}=e;l&&q(l,n)}function Kn(n){const{onDragend:l}=e;l&&q(l,n)}function vn(n){const{onDragstart:l}=e;l&&q(l,n)}function Dn(n){const{onDragover:l}=e;l&&q(l,n)}function gn(n){const{onDrop:l}=e;l&&q(l,n)}function ze(){an(),De()}function an(){$e.value=null}function De(){fe.value=0,Ge.value=null,Ue.value=null,Me.value=null,he()}function he(){ee&&(window.clearTimeout(ee),ee=null),de=null}function a(n,l){if(e.disabled||Ee(n,e.disabledField))return;if(e.internalUnifySelectCheck&&!e.multiple){N(n);return}const u=l?"check":"uncheck",{checkedKeys:C,indeterminateKeys:w}=A.value[u](n.key,Z.value,{cascade:e.cascade,checkStrategy:Q.value,allowNotLoaded:e.allowCheckingNotLoaded});fn(C,ie(C),{node:n.rawNode,action:u}),hn(w,ie(w))}function v(n){if(e.disabled)return;const{key:l}=n,{value:u}=k,C=u.findIndex(w=>w===l);if(~C){const w=Array.from(u);w.splice(C,1),Le(w,ie(w),{node:n.rawNode,action:"collapse"})}else{const w=f.value.getNode(l);if(!w||w.isLeaf)return;let H;if(e.accordion){const se=new Set(n.siblings.map(({key:ge})=>ge));H=u.filter(ge=>!se.has(ge)),H.push(l)}else H=u.concat(l);Le(H,ie(H),{node:n.rawNode,action:"expand"})}}function K(n){e.disabled||Pe.value||v(n)}function N(n){if(!(e.disabled||!e.selectable)){if(W.value=n.key,e.internalUnifySelectCheck){const{value:{checkedKeys:l,indeterminateKeys:u}}=G;e.multiple?a(n,!(l.includes(n.key)||u.includes(n.key))):fn([n.key],ie([n.key]),{node:n.rawNode,action:"check"})}if(e.multiple){const l=Array.from(oe.value),u=l.findIndex(C=>C===n.key);~u?e.cancelable&&l.splice(u,1):~u||l.push(n.key),tn(l,ie(l),{node:n.rawNode,action:~u?"unselect":"select"})}else oe.value.includes(n.key)?e.cancelable&&tn([],[],{node:n.rawNode,action:"unselect"}):tn([n.key],ie([n.key]),{node:n.rawNode,action:"select"})}}function O(n){if(ee&&(window.clearTimeout(ee),ee=null),n.isLeaf)return;de=n.key;const l=()=>{if(de!==n.key)return;const{value:u}=Ue;if(u&&u.key===n.key&&!k.value.includes(n.key)){const C=k.value.concat(n.key);Le(C,ie(C),{node:n.rawNode,action:"expand"})}ee=null,de=null};n.shallowLoaded?ee=window.setTimeout(()=>{l()},1e3):ee=window.setTimeout(()=>{Ne(n).then(()=>{l()})},1e3)}function X({event:n,node:l}){!e.draggable||e.disabled||Ee(l,e.disabledField)||(Un({event:n,node:l},!1),Rn({event:n,node:l.rawNode}))}function ye({event:n,node:l}){!e.draggable||e.disabled||Ee(l,e.disabledField)||Nn({event:n,node:l.rawNode})}function ve(n){n.target===n.currentTarget&&De()}function mn({event:n,node:l}){ze(),!(!e.draggable||e.disabled||Ee(l,e.disabledField))&&Kn({event:n,node:l.rawNode})}function ln({event:n,node:l}){!e.draggable||e.disabled||Ee(l,e.disabledField)||(Re=n.clientX,$e.value=l,vn({event:n,node:l.rawNode}))}function Un({event:n,node:l},u=!0){var C;if(!e.draggable||e.disabled||Ee(l,e.disabledField))return;const{value:w}=$e;if(!w)return;const{allowDrop:H,indent:se}=e;u&&Dn({event:n,node:l.rawNode});const ge=n.currentTarget,{height:Xe,top:Ye}=ge.getBoundingClientRect(),be=n.clientY-Ye;let M;H({node:l.rawNode,dropPosition:"inside",phase:"drag"})?be<=8?M="before":be>=Xe-8?M="after":M="inside":be<=Xe/2?M="before":M="after";const{value:we}=_n;let B,ae;const on=we(l.key);if(on===null){De();return}let jn=!1;M==="inside"?(B=l,ae="inside"):M==="before"?l.isFirstChild?(B=l,ae="before"):(B=m.value[on-1],ae="after"):(B=l,ae="after"),!B.isLeaf&&k.value.includes(B.key)&&(jn=!0,ae==="after"&&(B=m.value[on+1],B?ae="before":(B=l,ae="inside")));const zn=B;if(Ue.value=zn,!jn&&w.isLastChild&&w.key===B.key&&(ae="after"),ae==="after"){let Vn=Re-n.clientX,An=0;for(;Vn>=se/2&&B.parent!==null&&B.isLastChild&&An<1;)Vn-=se,An+=1,B=B.parent;fe.value=An}else fe.value=0;if((w.contains(B)||ae==="inside"&&((C=w.parent)===null||C===void 0?void 0:C.key)===B.key)&&!(w.key===zn.key&&w.key===B.key)){De();return}if(!H({node:B.rawNode,dropPosition:ae,phase:"drag"})){De();return}if(w.key===B.key)he();else if(de!==B.key)if(ae==="inside"){if(e.expandOnDragenter){if(O(B),!B.shallowLoaded&&de!==B.key){ze();return}}else if(!B.shallowLoaded){ze();return}}else he();else ae!=="inside"&&he();Me.value=ae,Ge.value=B}function yt({event:n,node:l,dropPosition:u}){if(!e.draggable||e.disabled||Ee(l,e.disabledField))return;const{value:C}=$e,{value:w}=Ge,{value:H}=Me;if(!(!C||!w||!H)&&e.allowDrop({node:w.rawNode,dropPosition:H,phase:"drag"})&&C.key!==w.key){if(H==="before"){const se=C.getNext({includeDisabled:!0});if(se&&se.key===w.key){De();return}}if(H==="after"){const se=C.getPrev({includeDisabled:!0});if(se&&se.key===w.key){De();return}}gn({event:n,node:w.rawNode,dragNode:C.rawNode,dropPosition:u}),ze()}}function bt(){qe()}function pt(){qe()}function kt(n){var l;if(e.virtualScroll||e.internalScrollable){const{value:u}=b;if(!((l=u==null?void 0:u.containerRef)===null||l===void 0)&&l.contains(n.relatedTarget))return;W.value=null}else{const{value:u}=x;if(u!=null&&u.contains(n.relatedTarget))return;W.value=null}}Ve(W,n=>{var l,u;if(n!==null){if(e.virtualScroll)(l=p.value)===null||l===void 0||l.scrollTo({key:n});else if(e.internalScrollable){const{value:C}=b;if(C===null)return;const w=(u=C.contentRef)===null||u===void 0?void 0:u.querySelector(`[data-key="${ut(n)}"]`);if(!w)return;C.scrollTo({el:w})}}}),lt(un,{loadingKeysRef:te,highlightKeySetRef:L,displayedCheckedKeysRef:Z,displayedIndeterminateKeysRef:Ce,mergedSelectedKeysRef:oe,mergedExpandedKeysRef:k,mergedThemeRef:d,mergedCheckStrategyRef:Q,nodePropsRef:$(e,"nodeProps"),disabledRef:$(e,"disabled"),checkableRef:$(e,"checkable"),selectableRef:$(e,"selectable"),expandOnClickRef:$(e,"expandOnClick"),onLoadRef:$(e,"onLoad"),draggableRef:$(e,"draggable"),blockLineRef:$(e,"blockLine"),indentRef:$(e,"indent"),cascadeRef:$(e,"cascade"),checkOnClickRef:$(e,"checkOnClick"),checkboxPlacementRef:e.checkboxPlacement,droppingMouseNodeRef:Ue,droppingNodeParentRef:Je,draggingNodeRef:$e,droppingPositionRef:Me,droppingOffsetLevelRef:fe,fNodesRef:m,pendingNodeKeyRef:W,showLineRef:$(e,"showLine"),disabledFieldRef:$(e,"disabledField"),internalScrollableRef:$(e,"internalScrollable"),internalCheckboxFocusableRef:$(e,"internalCheckboxFocusable"),internalTreeSelect:e.internalTreeSelect,renderLabelRef:$(e,"renderLabel"),renderPrefixRef:$(e,"renderPrefix"),renderSuffixRef:$(e,"renderSuffix"),renderSwitcherIconRef:$(e,"renderSwitcherIcon"),labelFieldRef:$(e,"labelField"),multipleRef:$(e,"multiple"),handleSwitcherClick:K,handleDragEnd:mn,handleDragEnter:X,handleDragLeave:ye,handleDragStart:ln,handleDrop:yt,handleDragOver:Un,handleSelect:N,handleCheck:a});function xt(n){var l;(l=p.value)===null||l===void 0||l.scrollTo(n)}const wt={handleKeydown:V,scrollTo:xt,getCheckedData:()=>{if(!e.checkable)return{keys:[],options:[]};const{checkedKeys:n}=G.value;return{keys:n,options:ie(n)}},getIndeterminateData:()=>{if(!e.checkable)return{keys:[],options:[]};const{indeterminateKeys:n}=G.value;return{keys:n,options:ie(n)}}},Mn=E(()=>{const{common:{cubicBezierEaseInOut:n},self:{fontSize:l,nodeBorderRadius:u,nodeColorHover:C,nodeColorPressed:w,nodeColorActive:H,arrowColor:se,loadingColor:ge,nodeTextColor:Xe,nodeTextColorDisabled:Ye,dropMarkColor:be,nodeWrapperPadding:M,nodeHeight:pe,lineHeight:we}}=d.value,B=Fn(M,"top"),ae=Fn(M,"bottom"),on=tt(dn(pe)-dn(B)-dn(ae));return{"--n-arrow-color":se,"--n-loading-color":ge,"--n-bezier":n,"--n-font-size":l,"--n-node-border-radius":u,"--n-node-color-active":H,"--n-node-color-hover":C,"--n-node-color-pressed":w,"--n-node-text-color":Xe,"--n-node-text-color-disabled":Ye,"--n-drop-mark-color":be,"--n-node-wrapper-padding":M,"--n-line-offset-top":`-${B}`,"--n-line-offset-bottom":`-${ae}`,"--n-node-content-height":on,"--n-line-height":we}}),We=r?ot("tree",void 0,Mn,e):void 0;return Object.assign(Object.assign({},wt),{mergedClsPrefix:t,mergedTheme:d,rtlEnabled:i,fNodes:Cn,aip:Pe,selfElRef:x,virtualListInstRef:p,scrollbarInstRef:b,handleFocusout:kt,handleDragLeaveTree:ve,handleScroll:bt,getScrollContainer:_,getScrollContent:o,handleAfterEnter:Sn,handleResize:pt,cssVars:r?void 0:Mn,themeClass:We==null?void 0:We.themeClass,onRender:We==null?void 0:We.onRender})},render(){var e;const{fNodes:t,internalRenderEmpty:r}=this;if(!t.length&&r)return r();const{mergedClsPrefix:s,blockNode:i,blockLine:d,draggable:x,disabled:b,internalFocusable:p,checkable:_,handleKeydown:o,rtlEnabled:h,handleFocusout:c,scrollbarProps:f}=this,R=p&&!b,A=R?"0":void 0,T=[`${s}-tree`,h&&`${s}-tree--rtl`,_&&`${s}-tree--checkable`,(d||i)&&`${s}-tree--block-node`,d&&`${s}-tree--block-line`],F=U=>"__motion"in U?y(Ca,{height:U.height,nodes:U.nodes,clsPrefix:s,mode:U.mode,onAfterEnter:this.handleAfterEnter}):y(vt,{key:U.key,tmNode:U,clsPrefix:s});if(this.virtualScroll){const{mergedTheme:U,internalScrollablePadding:G}=this,Q=Fn(G||"0");return y(Gn,Object.assign({},f,{ref:"scrollbarInstRef",onDragleave:x?this.handleDragLeaveTree:void 0,container:this.getScrollContainer,content:this.getScrollContent,class:T,theme:U.peers.Scrollbar,themeOverrides:U.peerOverrides.Scrollbar,tabindex:A,onKeydown:R?o:void 0,onFocusout:R?c:void 0}),{default:()=>{var Z;return(Z=this.onRender)===null||Z===void 0||Z.call(this),y(ia,{ref:"virtualListInstRef",items:this.fNodes,itemSize:dn(U.self.nodeHeight),ignoreItemResize:this.aip,paddingTop:Q.top,paddingBottom:Q.bottom,class:this.themeClass,style:[this.cssVars,{paddingLeft:Q.left,paddingRight:Q.right}],onScroll:this.handleScroll,onResize:this.handleResize,showScrollbar:!1,itemResizable:!0},{default:({item:Ce})=>F(Ce)})}})}const{internalScrollable:Y}=this;return T.push(this.themeClass),(e=this.onRender)===null||e===void 0||e.call(this),Y?y(Gn,Object.assign({},f,{class:T,tabindex:A,onKeydown:R?o:void 0,onFocusout:R?c:void 0,style:this.cssVars,contentStyle:{padding:this.internalScrollablePadding}}),{default:()=>y("div",{onDragleave:x?this.handleDragLeaveTree:void 0,ref:"selfElRef"},this.fNodes.map(F))}):y("div",{class:T,tabindex:A,ref:"selfElRef",style:this.cssVars,onKeydown:R?o:void 0,onFocusout:R?c:void 0,onDragleave:x?this.handleDragLeaveTree:void 0},t.length?t.map(F):it(this.$slots.empty,()=>[y(st,{class:`${s}-tree__empty`,theme:this.mergedTheme.peers.Empty,themeOverrides:this.mergedTheme.peerOverrides.Empty})]))}});function Qn(e,t){const{rawNode:r}=e;return Object.assign(Object.assign({},r),{label:r[t],value:e.key})}function Zn(e,t,r,s){const{rawNode:i}=e;return Object.assign(Object.assign({},i),{value:e.key,label:t.map(d=>d.rawNode[s]).join(r)})}const Da=ke([j("tree-select",`
 z-index: auto;
 outline: none;
 width: 100%;
 position: relative;
 `),j("tree-select-menu",`
 position: relative;
 overflow: hidden;
 margin: 4px 0;
 transition: box-shadow .3s var(--n-bezier), background-color .3s var(--n-bezier);
 border-radius: var(--n-menu-border-radius);
 box-shadow: var(--n-menu-box-shadow);
 background-color: var(--n-menu-color);
 outline: none;
 `,[j("tree","max-height: var(--n-menu-height);"),Oe("empty",`
 display: flex;
 padding: 12px 32px;
 flex: 1;
 justify-content: center;
 `),Oe("action",`
 padding: var(--n-action-padding);
 transition: 
 color .3s var(--n-bezier);
 border-color .3s var(--n-bezier);
 border-top: 1px solid var(--n-action-divider-color);
 color: var(--n-action-text-color);
 `),Lt()])]),Aa=Object.assign(Object.assign(Object.assign(Object.assign({},kn.props),{bordered:{type:Boolean,default:!0},cascade:Boolean,checkable:Boolean,clearable:Boolean,clearFilterAfterSelect:{type:Boolean,default:!0},consistentMenuWidth:{type:Boolean,default:!0},defaultShow:Boolean,defaultValue:{type:[String,Number,Array],default:null},disabled:{type:Boolean,default:void 0},filterable:Boolean,checkStrategy:{type:String,default:"all"},loading:Boolean,maxTagCount:[String,Number],multiple:Boolean,showPath:Boolean,separator:{type:String,default:" / "},options:{type:Array,default:()=>[]},placeholder:String,placement:{type:String,default:"bottom-start"},show:{type:Boolean,default:void 0},size:String,value:[String,Number,Array],to:On.propTo,menuProps:Object,virtualScroll:{type:Boolean,default:!0},status:String,renderTag:Function}),mt),{renderLabel:Function,renderPrefix:Function,renderSuffix:Function,nodeProps:Function,onBlur:Function,onFocus:Function,onLoad:Function,onUpdateShow:[Function,Array],onUpdateValue:[Function,Array],"onUpdate:value":[Function,Array],"onUpdate:show":[Function,Array],leafOnly:Boolean}),Ta=ue({name:"TreeSelect",props:Aa,setup(e){const t=S(null),r=S(null),s=S(null),i=S(null),{mergedClsPrefixRef:d,namespaceRef:x,inlineThemeDisabled:b}=at(e),{localeRef:p}=ca("Select"),{mergedSizeRef:_,mergedDisabledRef:o,mergedStatusRef:h,nTriggerFormBlur:c,nTriggerFormChange:f,nTriggerFormFocus:R,nTriggerFormInput:A}=Et(e),T=S(e.defaultValue),F=$(e,"value"),Y=He(F,T),U=S(e.defaultShow),G=$(e,"show"),Q=He(G,U),Z=S(""),Ce=E(()=>{const{filter:a}=e;if(a)return a;const{labelField:v}=e;return(K,N)=>K.length?N[v].toLowerCase().includes(K.toLowerCase()):!0}),J=E(()=>dt(e.options,gt(e.keyField,e.childrenField,e.disabledField,void 0))),{value:xe}=Y,oe=S(e.checkable?null:Array.isArray(xe)&&xe.length?xe[xe.length-1]:null),me=E(()=>e.multiple&&e.cascade&&e.checkable),Se=S(e.defaultExpandAll?void 0:e.defaultExpandedKeys||e.expandedKeys),Te=$(e,"expandedKeys"),k=He(Te,Se),m=S(!1),W=E(()=>{const{placeholder:a}=e;return a!==void 0?a:p.value.placeholder}),V=E(()=>e.checkable?[]:ee.value),ee=E(()=>{const{value:a}=Y;return e.multiple?Array.isArray(a)?a:[]:a===null||Array.isArray(a)?[]:[a]}),de=E(()=>{const{multiple:a,showPath:v,separator:K,labelField:N}=e;if(a)return null;const{value:O}=Y;if(!Array.isArray(O)&&O!==null){const{value:X}=J,ye=X.getNode(O);if(ye!==null)return v?Zn(ye,X.getPath(O).treeNodePath,K,N):Qn(ye,N)}return null}),g=E(()=>{const{multiple:a,showPath:v,separator:K}=e;if(!a)return null;const{value:N}=Y;if(Array.isArray(N)){const O=[],{value:X}=J,{checkedKeys:ye}=X.getCheckedKeys(N,{checkStrategy:e.checkStrategy,cascade:me.value,allowNotLoaded:e.allowCheckingNotLoaded}),{labelField:ve}=e;return ye.forEach(mn=>{const ln=X.getNode(mn);ln!==null&&O.push(v?Zn(ln,X.getPath(mn).treeNodePath,K,ve):Qn(ln,ve))}),O}return[]}),P=E(()=>{const{self:{menuPadding:a}}=an.value;return a});function L(){var a;(a=r.value)===null||a===void 0||a.focus()}function te(){var a;(a=r.value)===null||a===void 0||a.focusInput()}function Be(a){const{onUpdateShow:v,"onUpdate:show":K}=e;v&&q(v,a),K&&q(K,a),U.value=a}function Re(a,v,K){const{onUpdateValue:N,"onUpdate:value":O}=e;N&&q(N,a,v,K),O&&q(O,a,v,K),T.value=a,A(),f()}function $e(a,v){const{onUpdateIndeterminateKeys:K,"onUpdate:indeterminateKeys":N}=e;K&&q(K,a,v),N&&q(N,a,v)}function Ge(a,v,K){const{onUpdateExpandedKeys:N,"onUpdate:expandedKeys":O}=e;N&&q(N,a,v,K),O&&q(O,a,v,K),Se.value=a}function Ue(a){const{onFocus:v}=e;v&&v(a),R()}function Me(a){fe();const{onBlur:v}=e;v&&v(a),c()}function fe(){Be(!1)}function Je(){o.value||(Z.value="",Be(!0),e.filterable&&te())}function en(){Z.value=""}function nn(a){var v;Q.value&&(!((v=r.value)===null||v===void 0)&&v.$el.contains(jt(a))||fe())}function je(){o.value||(Q.value?e.filterable||fe():Je())}function Ne(a){const{value:{getNode:v}}=J;return a.map(K=>{var N;return((N=v(K))===null||N===void 0?void 0:N.rawNode)||null})}function Pe(a,v,K){const N=Ne(a),O=K.action==="check"?"select":"unselect",X=K.node;e.multiple?(Re(a,N,{node:X,action:O}),e.filterable&&(te(),e.clearFilterAfterSelect&&(Z.value=""))):(a.length?Re(a[0],N[0]||null,{node:X,action:O}):Re(null,null,{node:X,action:O}),fe(),L())}function Ke(a){e.checkable&&$e(a,Ne(a))}function _n(a){var v;!((v=i.value)===null||v===void 0)&&v.contains(a.relatedTarget)||(m.value=!0,Ue(a))}function Cn(a){var v;!((v=i.value)===null||v===void 0)&&v.contains(a.relatedTarget)||(m.value=!1,Me(a))}function qe(a){var v,K,N;!((v=i.value)===null||v===void 0)&&v.contains(a.relatedTarget)||!((N=(K=r.value)===null||K===void 0?void 0:K.$el)===null||N===void 0)&&N.contains(a.relatedTarget)||(m.value=!0,Ue(a))}function Sn(a){var v,K,N;!((v=i.value)===null||v===void 0)&&v.contains(a.relatedTarget)||!((N=(K=r.value)===null||K===void 0?void 0:K.$el)===null||N===void 0)&&N.contains(a.relatedTarget)||(m.value=!1,Me(a))}function ie(a){a.stopPropagation();const{multiple:v}=e;!v&&e.filterable&&fe(),v?Re([],[],{node:null,action:"clear"}):Re(null,null,{node:null,action:"clear"})}function Le(a){const{value:v}=Y;if(Array.isArray(v)){const{value:K}=J,{checkedKeys:N}=K.getCheckedKeys(v,{cascade:me.value,allowNotLoaded:e.allowCheckingNotLoaded}),O=N.findIndex(X=>X===a.value);if(~O){const X=N[O],ye=Ne([X])[0];if(e.checkable){const{checkedKeys:ve}=K.uncheck(a.value,N,{checkStrategy:e.checkStrategy,cascade:me.value,allowNotLoaded:e.allowCheckingNotLoaded});Re(ve,Ne(ve),{node:ye,action:"delete"})}else{const ve=Array.from(N);ve.splice(O,1),Re(ve,Ne(ve),{node:ye,action:"delete"})}}}}function fn(a){const{value:v}=a.target;Z.value=v}function hn(a){const{value:v}=s;v&&v.handleKeydown(a)}function tn(a){a.key==="Enter"?(Q.value?(hn(a),e.multiple||(fe(),L())):Je(),a.preventDefault()):a.key==="Escape"?Q.value&&(zt(a),fe(),L()):Q.value?hn(a):a.key==="ArrowDown"&&Je()}function Rn(){fe(),L()}function Nn(a){En(a,"action")||a.preventDefault()}const Kn=E(()=>{const{renderTag:a}=e;if(a)return function({option:K,handleClose:N}){const{value:O}=K;if(O!==void 0){const X=J.value.getNode(O);if(X)return a({option:X.rawNode,handleClose:N})}return O}});lt(Bn,{pendingNodeKeyRef:oe,dataTreeMate:J});function vn(){var a;Q.value&&((a=t.value)===null||a===void 0||a.syncPosition())}ra(i,vn);const Dn=ft(e),gn=E(()=>{if(e.checkable){const a=Y.value;return e.multiple&&Array.isArray(a)?J.value.getCheckedKeys(a,{cascade:e.cascade,checkStrategy:Dn.value,allowNotLoaded:e.allowCheckingNotLoaded}):{checkedKeys:Array.isArray(a)||a===null?[]:[a],indeterminateKeys:[]}}return{checkedKeys:[],indeterminateKeys:[]}}),ze={getCheckedData:()=>{const{checkedKeys:a}=gn.value;return{keys:a,options:Ne(a)}},getIndeterminateData:()=>{const{indeterminateKeys:a}=gn.value;return{keys:a,options:Ne(a)}},focus:()=>{var a;return(a=r.value)===null||a===void 0?void 0:a.focus()},focusInput:()=>{var a;return(a=r.value)===null||a===void 0?void 0:a.focusInput()},blur:()=>{var a;return(a=r.value)===null||a===void 0?void 0:a.blur()},blurInput:()=>{var a;return(a=r.value)===null||a===void 0?void 0:a.blurInput()}},an=kn("TreeSelect","-tree-select",Da,ga,e,d),De=E(()=>{const{common:{cubicBezierEaseInOut:a},self:{menuBoxShadow:v,menuBorderRadius:K,menuColor:N,menuHeight:O,actionPadding:X,actionDividerColor:ye,actionTextColor:ve}}=an.value;return{"--n-menu-box-shadow":v,"--n-menu-border-radius":K,"--n-menu-color":N,"--n-menu-height":O,"--n-bezier":a,"--n-action-padding":X,"--n-action-text-color":ve,"--n-action-divider-color":ye}}),he=b?ot("tree-select",void 0,De,e):void 0;return Object.assign(Object.assign({},ze),{menuElRef:i,mergedStatus:h,triggerInstRef:r,followerInstRef:t,treeInstRef:s,mergedClsPrefix:d,mergedValue:Y,mergedShow:Q,namespace:x,adjustedTo:On(e),isMounted:Ot(),focused:m,menuPadding:P,mergedPlaceholder:W,mergedExpandedKeys:k,treeSelectedKeys:V,treeCheckedKeys:ee,mergedSize:_,mergedDisabled:o,selectedOption:de,selectedOptions:g,pattern:Z,pendingNodeKey:oe,mergedCascade:me,mergedFilter:Ce,selectionRenderTag:Kn,handleTriggerOrMenuResize:vn,doUpdateExpandedKeys:Ge,handleMenuLeave:en,handleTriggerClick:je,handleMenuClickoutside:nn,handleUpdateCheckedKeys:Pe,handleUpdateIndeterminateKeys:Ke,handleTriggerFocus:_n,handleTriggerBlur:Cn,handleMenuFocusin:qe,handleMenuFocusout:Sn,handleClear:ie,handleDeleteOption:Le,handlePatternInput:fn,handleKeydown:tn,handleTabOut:Rn,handleMenuMousedown:Nn,mergedTheme:an,cssVars:b?void 0:De,themeClass:he==null?void 0:he.themeClass,onRender:he==null?void 0:he.onRender})},render(){const{mergedTheme:e,mergedClsPrefix:t,$slots:r}=this;return y("div",{class:`${t}-tree-select`},y(na,null,{default:()=>[y(ta,null,{default:()=>y(da,{ref:"triggerInstRef",onResize:this.handleTriggerOrMenuResize,status:this.mergedStatus,focused:this.focused,clsPrefix:t,theme:e.peers.InternalSelection,themeOverrides:e.peerOverrides.InternalSelection,renderTag:this.selectionRenderTag,selectedOption:this.selectedOption,selectedOptions:this.selectedOptions,size:this.mergedSize,bordered:this.bordered,placeholder:this.mergedPlaceholder,disabled:this.mergedDisabled,active:this.mergedShow,loading:this.loading,multiple:this.multiple,maxTagCount:this.maxTagCount,showArrow:!0,filterable:this.filterable,clearable:this.clearable,pattern:this.pattern,onPatternInput:this.handlePatternInput,onClear:this.handleClear,onClick:this.handleTriggerClick,onFocus:this.handleTriggerFocus,onBlur:this.handleTriggerBlur,onDeleteOption:this.handleDeleteOption,onKeydown:this.handleKeydown},{arrow:()=>{var s,i;return[(i=(s=this.$slots).arrow)===null||i===void 0?void 0:i.call(s)]}})}),y(aa,{ref:"followerInstRef",show:this.mergedShow,placement:this.placement,to:this.adjustedTo,teleportDisabled:this.adjustedTo===On.tdkey,containerClass:this.namespace,width:this.consistentMenuWidth?"target":void 0,minWidth:"target"},{default:()=>y(Bt,{name:"fade-in-scale-up-transition",appear:this.isMounted,onLeave:this.handleMenuLeave},{default:()=>{var s;if(!this.mergedShow)return null;const{mergedClsPrefix:i,checkable:d,multiple:x,menuProps:b,options:p}=this;return(s=this.onRender)===null||s===void 0||s.call(this),$t(y("div",Object.assign({},b,{class:[`${i}-tree-select-menu`,b==null?void 0:b.class,this.themeClass],ref:"menuElRef",style:[(b==null?void 0:b.style)||"",this.cssVars],tabindex:0,onMousedown:this.handleMenuMousedown,onKeydown:this.handleKeydown,onFocusin:this.handleMenuFocusin,onFocusout:this.handleMenuFocusout}),y(Ka,{ref:"treeInstRef",blockLine:!0,allowCheckingNotLoaded:this.allowCheckingNotLoaded,showIrrelevantNodes:!1,animated:!1,pattern:this.pattern,filter:this.mergedFilter,data:p,cancelable:x,labelField:this.labelField,keyField:this.keyField,disabledField:this.disabledField,childrenField:this.childrenField,theme:e.peers.Tree,themeOverrides:e.peerOverrides.Tree,defaultExpandAll:this.defaultExpandAll,defaultExpandedKeys:this.defaultExpandedKeys,expandedKeys:this.mergedExpandedKeys,checkedKeys:this.treeCheckedKeys,selectedKeys:this.treeSelectedKeys,checkable:d,checkStrategy:this.checkStrategy,cascade:this.mergedCascade,leafOnly:this.leafOnly,multiple:this.multiple,renderLabel:this.renderLabel,renderPrefix:this.renderPrefix,renderSuffix:this.renderSuffix,renderSwitcherIcon:this.renderSwitcherIcon,nodeProps:this.nodeProps,virtualScroll:this.consistentMenuWidth&&this.virtualScroll,internalTreeSelect:!0,internalUnifySelectCheck:!0,internalScrollable:!0,internalScrollablePadding:this.menuPadding,internalFocusable:!1,internalCheckboxFocusable:!1,internalRenderEmpty:()=>y("div",{class:`${i}-tree-select-menu__empty`},it(r.empty,()=>[y(st,{theme:e.peers.Empty,themeOverrides:e.peerOverrides.Empty})])),onLoad:this.onLoad,onUpdateCheckedKeys:this.handleUpdateCheckedKeys,onUpdateIndeterminateKeys:this.handleUpdateIndeterminateKeys,onUpdateExpandedKeys:this.doUpdateExpandedKeys}),Mt(r.action,_=>_?y("div",{class:`${i}-tree-select-menu__action`,"data-action":!0},_):null),y(la,{onFocus:this.handleTabOut})),[[Ut,this.handleMenuClickoutside,void 0,{capture:!0}]])}})})]}))}}),Fa={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},bn=ue({name:"EditOutlined",render:function(t,r){return ce(),Fe("svg",Fa,r[0]||(r[0]=[D("path",{d:"M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 0 0 0-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 0 0 9.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3l-362.7 362.6l-88.9 15.7l15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z",fill:"currentColor"},null,-1)]))}}),Ia=D("div",{class:"flex justify-between items-center w-full"},[D("h2",{class:"text-xl font-bold"},"SPD仓库列表")],-1),Pa={class:"flex justify-end gap-4 mt-4"},La=ue({__name:"dialog",props:{visible:{type:Boolean}},emits:["update:visible","cancel","bind-success"],setup(e,{emit:t}){const r=e,s=S(null),i=S([]),d=async()=>{try{const o=await Vt();if(console.log("完整响应:",o),o!=null&&o.data&&Array.isArray(o.data)){const h=c=>c.map(f=>({id:f.id,name:f.name,...f.children?{children:h(f.children)}:{}}));i.value=h(o.data),console.log("处理后数据:",i.value)}else console.warn("响应数据为空或格式不正确",o),x.warning("未获取到有效的仓库数据"),i.value=[]}catch(o){console.error("获取仓库列表失败:",o),x.error("获取仓库列表失败"),i.value=[]}},x=xn();Ve(()=>r.visible,o=>{o&&d()});const b=()=>{t("update:visible",!1),t("cancel")},p=()=>{if(!s.value){x.warning("请选择仓库");return}const o=_(i.value,s.value);o&&(t("bind-success",{rpName:o.name,rpId:s.value.toString()}),t("update:visible",!1))},_=(o,h)=>{for(const c of o){if(c.id===h)return c;if(c.children){const f=_(c.children,h);if(f)return f}}return null};return(o,h)=>{const c=Ta,f=_e,R=cn,A=wn;return ce(),sn(A,{show:o.visible,"onUpdate:show":b,preset:"card",closable:"",style:{width:"500px",height:"400px"}},{header:z(()=>[Ia]),default:z(()=>[I(R,{style:{height:"calc(100% - 40px)"}},{default:z(()=>[I(c,{value:s.value,"onUpdate:value":h[0]||(h[0]=T=>s.value=T),options:i.value,"key-field":"id","label-field":"name","children-field":"children",multiple:!1,"default-expand-all":!0,style:{height:"calc(100% - 60px)"},placeholder:"请选择仓库"},null,8,["value","options"]),D("div",Pa,[I(f,{onClick:b},{default:z(()=>[Ae("返回")]),_:1}),I(f,{type:"primary",onClick:p},{default:z(()=>[Ae("确定")]),_:1})])]),_:1})]),_:1},8,["show"])}}});const Ea=D("div",{class:"flex justify-between items-center w-full"},[D("h2",{class:"text-xl font-bold"},"编辑货柜")],-1),Oa={class:"grid grid-cols-2 gap-4"},Ba={class:"flex items-center"},$a=D("label",{for:"name",class:"mr-4"},"货柜名称:",-1),Ua={class:"flex items-center"},Ma=D("label",{for:"type",class:"mr-4"},"货柜类型:",-1),ja={class:"flex items-center"},za=D("label",{for:"ipAddress",class:"mr-8"},"IP地址:",-1),Va={class:"flex items-center"},Ha=D("label",{for:"macAddress",class:"mr-4"},"Mac地址:",-1),Ga={class:"flex justify-end mt-4"},qa=ue({__name:"dialog",props:{visible:{type:Boolean},rowData:{}},emits:["update:visible","refresh"],setup(e,{emit:t}){const r=e,s=S({id:null,name:"",type:"",ipAddress:"",macAddress:""}),i=xn(),d=S(!1),x=S([{label:"主柜",value:"main"},{label:"副柜",value:"secondary"}]),b=()=>{s.value={id:null,name:"",type:"",ipAddress:"",macAddress:""}};Ve(()=>r.rowData,o=>{o&&(s.value={id:o.id,name:o.name||"",type:o.type||"",ipAddress:o.ipAddress||"",macAddress:o.macAddress||""})},{immediate:!0});const p=()=>{t("update:visible",!1)},_=async()=>{try{d.value=!0;let{ipAddress:o,macAddress:h,...c}=s.value,{error:f}=await Ht(c);if(f)return;i.success("货柜信息更新成功"),t("update:visible",!1),t("refresh"),b()}catch(o){console.error("更新货柜信息失败:",o),i.error("货柜信息更新失败")}finally{d.value=!1}};return(o,h)=>{const c=pn,f=sa,R=cn,A=_e,T=wn;return ce(),sn(T,{show:o.visible,"onUpdate:show":p,preset:"card",closable:"",style:{width:"fit-content"}},{header:z(()=>[Ea]),default:z(()=>[I(R,null,{default:z(()=>[D("div",Oa,[D("div",Ba,[$a,I(c,{value:s.value.name,"onUpdate:value":h[0]||(h[0]=F=>s.value.name=F),id:"name",style:{width:"200px"}},null,8,["value"])]),D("div",Ua,[Ma,I(f,{value:s.value.type,"onUpdate:value":h[1]||(h[1]=F=>s.value.type=F),options:x.value,id:"type",style:{width:"200px"},disabled:""},null,8,["value","options"])]),D("div",ja,[za,I(c,{value:s.value.ipAddress,"onUpdate:value":h[2]||(h[2]=F=>s.value.ipAddress=F),id:"ipAddress",disabled:"",style:{width:"200px"}},null,8,["value"])]),D("div",Va,[Ha,I(c,{value:s.value.macAddress,"onUpdate:value":h[3]||(h[3]=F=>s.value.macAddress=F),id:"macAddress",disabled:"",style:{width:"200px"}},null,8,["value"])])])]),_:1}),D("div",Ga,[I(A,{onClick:p},{default:z(()=>[Ae("返回")]),_:1}),I(A,{type:"primary",style:{"margin-left":"10px"},onClick:_},{default:z(()=>[Ae("确定")]),_:1})])]),_:1},8,["show"])}}});const Wa=D("div",{class:"flex justify-between items-center w-full"},[D("h2",{class:"text-xl font-bold"},"确认")],-1),Xa={key:1,class:"flex justify-end mt-4"},Ya=ue({__name:"dialog",props:{visible:{type:Boolean},rowData:{}},emits:["update:visible","confirm","cancel"],setup(e,{emit:t}){const r=()=>{t("update:visible",!1),t("cancel")},s=()=>{t("confirm"),t("update:visible",!1)};return(i,d)=>{const x=cn,b=_e,p=wn;return ce(),sn(p,{show:i.visible,"onUpdate:show":r,preset:"card",closable:"",style:{width:"fit-content"}},{header:z(()=>[Wa]),default:z(()=>[i.rowData&&i.rowData.cabinetType!=="主柜"?(ce(),sn(x,{key:0},{default:z(()=>[D("div",null," 当前货柜组的主柜为 "+Ie(i.rowData.currentMainCabinet||"货柜A")+"，是否解绑 "+Ie(i.rowData.currentMainCabinet||"货柜A")+" 并设置 "+Ie(i.rowData.newMainCabinet||"货柜B")+" 为主柜？ ",1)]),_:1})):qn("",!0),i.rowData&&i.rowData.cabinetType!=="主柜"?(ce(),Fe("div",Xa,[I(b,{onClick:r},{default:z(()=>[Ae("取消")]),_:1}),I(b,{type:"primary",style:{"margin-left":"10px"},onClick:s},{default:z(()=>[Ae("确定")]),_:1})])):qn("",!0)]),_:1},8,["show"])}}});const Qa=D("div",{class:"flex justify-between items-center w-full"},[D("h2",{class:"text-xl font-bold"},"批量添加货柜")],-1),Za={class:"flex justify-end mt-4 gap-4"},Ja=ue({__name:"dialog",props:{visible:{type:Boolean},existingCabinets:{},cabinetGroupId:{}},emits:["update:visible","cancel","refresh"],setup(e,{emit:t}){const r=e,s=rt(),i=xn(),d=S([]),x=[{title:()=>y(Ln,{checked:d.value.length>0&&d.value.every(o=>o.selected),indeterminate:d.value.some(o=>o.selected)&&!d.value.every(o=>o.selected),onUpdateChecked:o=>{d.value.forEach(h=>{h.selected=o})}}),key:"selected",render:o=>y(Ln,{checked:o.selected,onUpdateChecked:h=>{o.selected=h}})},{title:"货柜名称",key:"name"},{title:"IP地址",key:"ipAddress"},{title:"MAC地址",key:"macAddress"},{title:"状态",key:"status",render:o=>y("span",{style:{color:o.status==="offline"?"red":"inherit"}},o.status==="online"?"在线":"离线")}],b=E(()=>s.getHeartbeatDevices);Ve(()=>r.visible,o=>{o?d.value=Object.values(b.value).map(h=>({cabinetGroupID:r.cabinetGroupId,id:`${h.ipAddress}-${h.macAddress}`,name:h.name||`货柜-${d.value.length+1}`,ipAddress:h.ipAddress,macAddress:h.macAddress,status:h.status,selected:!1})):d.value=[]});const p=()=>{t("update:visible",!1),t("cancel")},_=async()=>{const o=d.value.filter(R=>R.selected);if(o.length===0){i.warning("请至少选择一个货柜");return}const h=o.map(R=>({cabinetGroupID:r.cabinetGroupId,ipAddress:R.ipAddress,macAddress:R.macAddress,name:R.name,status:R.status}));let{data:c,error:f}=await Gt(h);f||(s.fetchDevices(),i.success(`已成功添加${o.length}个货柜`),t("update:visible",!1),t("refresh"))};return(o,h)=>{const c=cn,f=wn;return ce(),sn(f,{show:o.visible,"onUpdate:show":p,preset:"card",closable:"",style:{width:"47%",height:"30rem"}},{header:z(()=>[Qa]),default:z(()=>[I(c,null,{default:z(()=>[I(le(ct),{columns:x,data:d.value,style:{"margin-top":"20px"}},null,8,["data"]),D("div",Za,[I(le(_e),{onClick:p},{default:z(()=>[Ae("取消")]),_:1}),I(le(_e),{type:"primary",onClick:_},{default:z(()=>[Ae("确定添加")]),_:1})])]),_:1})]),_:1},8,["show"])}}});const $n=e=>(Jt("data-v-6e90f19a"),e=e(),ea(),e),el={class:"flex justify-end"},nl={class:"mt-8 flex gap-4"},tl={class:"flex-1 h-full"},al={key:0},ll={class:"ml-4"},ol={key:1,class:"inline-flex items-center"},il=$n(()=>D("span",{class:"mr-2"},"货柜组名称:",-1)),rl={class:"ml-4"},dl={class:"flex-1 h-full"},sl={key:0},cl={key:1,class:"inline-flex items-center"},ul=$n(()=>D("span",{class:"mr-2"},"科室名称:",-1)),fl={key:2},hl={key:3,class:"inline-flex items-center"},vl=$n(()=>D("span",{class:"mr-2"},"科室位置:",-1)),gl={class:"mt-4"},ml={class:"mt-4"},yl=ue({__name:"index",setup(e){const t=S(!1),r=xn(),s=qt(),i=S(!1),d=S(!1),x=rt(),b=S([{type:"selection"},{title:"货柜组名称",key:"cabinetGroup.name"},{title:"货柜名称",key:"name"},{title:"货柜类型",key:"type",render:k=>k.type==="main"?"主柜":"副柜"},{title:"IP地址",key:"ipAddress"},{title:"Mac地址",key:"macAddress"},{title:"状态",key:"status",render:k=>y("span",{style:{color:k.status==="offline"?"red":"inherit"}},k.status==="online"?"在线":"离线")},{title:"操作",key:"actions",render:k=>{const m=[];return k.type!=="main"&&m.push(y(_e,{type:"primary",onClick:()=>F(k),size:"medium",class:"mr-2"},"设置为主柜")),m.push(y(_e,{type:"primary",onClick:()=>{console.log("当前行数据:",k),t.value=!0,p.value=k},size:"medium",class:"mr-2"},"编辑"),y(_e,{type:"error",onClick:()=>Y(k),size:"medium"},"删除")),k.type==="main"&&m.unshift(y(_e,{type:"default",disabled:!0,size:"medium",class:"mr-2"},"已绑定")),m}}]),p=S({}),_=S([]),o=S(""),h=S(""),c=S({});nt(async()=>{try{const k=await Wn(1);_.value=k.data||[];const m=await Wt();m.data&&(c.value=m.data,c.value.dept&&(o.value=c.value.dept.name||"",h.value=c.value.dept.address||""))}catch(k){console.error("数据加载失败:",k)}});const f=S(!1),R=S({}),A=E(()=>_.value.find(k=>k.type==="main")),T=E(()=>{var k;return(k=A.value)==null?void 0:k.name}),F=async k=>{try{s.warning({title:"确认设置",content:T.value?`当前主柜为${T.value}，是否解绑并设置${k.name}为主柜？`:`是否确定将${k.name}设置为主柜？`,positiveText:"确定",negativeText:"取消",onPositiveClick:async()=>{try{if((await Xt({newMainCabinetId:k.id})).error)return;r.success("设置成功"),x.fetchDevices(),oe()}catch(m){console.error("设置主柜失败:",m),r.error("设置主柜失败")}}})}catch(m){console.error("设置操作异常:",m)}},Y=async k=>{try{s.warning({title:"确认删除",content:`是否确认删除货柜${k.name}?`,positiveText:"确定",negativeText:"取消",onPositiveClick:async()=>{try{const{data:m,error:W}=await Yt({ID:k.id});if(W)return;r.success(m+""),oe(),x.fetchDevices()}catch(m){console.error("删除货柜失败:",m),r.error("删除货柜失败")}}})}catch(m){console.error("删除操作异常:",m)}},U=()=>{i.value=!0},G=S(!1),Q=()=>{G.value=!0},Z=S(!1),Ce=()=>{Z.value=!0},J=S(!1),xe=k=>{const m=_.value.findIndex(W=>W.id===k.id);m!==-1&&(_.value[m]={..._.value[m],name:k.name,type:k.type==="main"?"主柜":"副柜"})},oe=async()=>{try{const k=await Wn(1);_.value=k.data||[]}catch(k){console.error("刷新数据失败:",k)}},me=async()=>{var k,m;try{d.value=!0;const W={sdCode:c.value.sdCode,name:c.value.name,deptName:(k=c.value.dept)==null?void 0:k.name,deptAddress:(m=c.value.dept)==null?void 0:m.address,addressIP:c.value.addressIp,rpId:c.value.rpId,rpName:c.value.rpName},{data:V,error:ee}=await Zt(W);if(ee)return;r.success("保存成功"),i.value=!1,G.value=!1,Z.value=!1,oe()}catch(W){console.error("保存失败:",W),r.error("保存失败")}finally{d.value=!1}},Se=k=>{c.value.rpName=k.rpName,c.value.rpId=k.rpId},Te=S(!1);return(k,m)=>{const W=cn;return ce(),Fe(Qt,null,[D("div",el,[D("div",null,[I(le(_e),{type:"primary",onClick:me},{default:z(()=>[Ae("保存所有修改")]),_:1})])]),D("div",nl,[D("div",tl,[I(W,{class:"h-full",title:"货柜组信息"},{default:z(()=>[i.value?(ce(),Fe("div",ol,[il,I(le(pn),{value:c.value.name,"onUpdate:value":m[0]||(m[0]=V=>c.value.name=V),disabled:d.value,size:"small",style:{width:"200px"}},null,8,["value","disabled"])])):(ce(),Fe("div",al,[D("span",null,"货柜组名称: "+Ie(c.value.name),1),I(le(yn),{component:le(bn),class:"ml-2 cursor-pointer",onClick:U},null,8,["component"]),D("span",ll,"IP地址: "+Ie(c.value.addressIp),1)])),D("div",null,[D("span",null,"绑定SPD仓库名称: "+Ie(c.value.rpName),1),I(le(yn),{component:le(bn),class:"ml-2 cursor-pointer",onClick:m[1]||(m[1]=V=>J.value=!0)},null,8,["component"]),D("span",rl,"仓库ID: "+Ie(c.value.rpId),1)])]),_:1})]),D("div",dl,[I(W,{class:"h-full",title:"科室信息"},{default:z(()=>{var V,ee;return[G.value?(ce(),Fe("div",cl,[ul,I(le(pn),{value:c.value.dept.name,"onUpdate:value":m[2]||(m[2]=de=>c.value.dept.name=de),disabled:d.value,size:"small",style:{width:"200px"}},null,8,["value","disabled"])])):(ce(),Fe("div",sl,[D("span",null,"科室名称: "+Ie((V=c.value.dept)==null?void 0:V.name),1),I(le(yn),{component:le(bn),class:"ml-2 cursor-pointer",onClick:Q},null,8,["component"])])),Z.value?(ce(),Fe("div",hl,[vl,I(le(pn),{value:c.value.dept.address,"onUpdate:value":m[3]||(m[3]=de=>c.value.dept.address=de),disabled:d.value,size:"small",style:{width:"200px"}},null,8,["value","disabled"])])):(ce(),Fe("div",fl,[D("span",null,"科室位置: "+Ie((ee=c.value.dept)==null?void 0:ee.address),1),I(le(yn),{component:le(bn),class:"ml-2 cursor-pointer",onClick:Ce},null,8,["component"])]))]}),_:1})])]),D("div",gl,[I(le(_e),{type:"primary",onClick:m[4]||(m[4]=V=>Te.value=!0)},{default:z(()=>[Ae("批量添加货柜")]),_:1})]),D("div",ml,[I(le(ct),{columns:b.value,data:_.value,"row-key":V=>V.id},null,8,["columns","data","row-key"])]),I(La,{visible:J.value,"onUpdate:visible":m[5]||(m[5]=V=>J.value=V),rowData:{},onBindSuccess:Se},null,8,["visible"]),I(qa,{visible:t.value,"onUpdate:visible":m[6]||(m[6]=V=>t.value=V),rowData:p.value,onSubmit:xe,onRefresh:oe},null,8,["visible","rowData"]),I(Ya,{visible:f.value,"onUpdate:visible":m[7]||(m[7]=V=>f.value=V),rowData:R.value},null,8,["visible","rowData"]),I(Ja,{"existing-cabinets":_.value,visible:Te.value,"onUpdate:visible":m[8]||(m[8]=V=>Te.value=V),"cabinet-group-id":c.value.id,onRefresh:oe},null,8,["existing-cabinets","visible","cabinet-group-id"])],64)}}});const Pl=ua(yl,[["__scopeId","data-v-6e90f19a"]]);export{Pl as default};
