import{d as W,aS as P,l as k,bb as U,r as v,o as F,an as b,ao as T,ap as o,aw as e,ar as l,as as a,ax as i,aB as M,bc as D,bd as L,a7 as R,aC as j,aD as q}from"./index.js";import{S as E}from"./Settings.js";import{_ as N,a as G}from"./RadioGroup.js";import{_ as r}from"./text.js";import{_ as A}from"./TimePicker.js";import{_ as d,a as I}from"./Checkbox.js";import{_ as w}from"./Space.js";import{N as J}from"./Icon.js";import{_ as K}from"./_plugin-vue_export-helper.js";import"./use-merged-state.js";import"./get-slot.js";import"./use-compitable.js";import"./FocusDetector.js";import"./next-frame-once.js";import"./Input.js";import"./format-length.js";const n=g=>(j("data-v-31a2c373"),g=g(),q(),g),O={class:"auto-apply-setting p-4"},Q={style:{"font-size":"24px",display:"flex","align-items":"center","margin-bottom":"8px",color:"var(--primary)"}},X=n(()=>o("label",{class:"text-lg font-medium"},"自动申领补货设置",-1)),Y={class:"mb-8 mt-10 pl-20"},Z=n(()=>o("label",{class:"mr-10 font-medium"}," 自动申领补货方式： ",-1)),$=n(()=>o("div",{id:"desc",class:"mt-5"},[o("label",{class:"text-gray-400 block"}," 定量补货：按照固定的数量补货，比如到补货点或者补货时间，始终补充200根香烟，这种指定补货数量的补货方式成为定量补货。 补货数量=订货补货数量（设置时需要取整） "),o("label",{class:"text-gray-400 block"}," 最大库存量补货：按照最大库存量动态确定补货数量， 公式为：补货数量=取整类型（取整基数（最大库存数量-实时库存）），向上取整时订单数量总会多一个，尤其对于货位数量有少量便宜的情况。 ")],-1)),ee={class:"mb-8 mt-10 pl-20 full"},ae=n(()=>o("label",{class:"mr-10 font-medium"}," 自动申领补货触发规则： ",-1)),te={key:0,class:"ml-5 flex",style:{width:"100%",height:"50px",display:"flex","align-items":"center"}},le=n(()=>o("label",{style:{"font-size":"16px"}},"时间：",-1)),se=n(()=>o("label",{style:{"font-size":"14px",color:"#797979","margin-left":"2px"}}," 请设置再订货点触发的时间， 例如设置为08:00，则当库存低于再订货点时， 系统会自动在每天的08:00触发补货操作。 ",-1)),oe={key:1,class:"ml-2"},ie=n(()=>o("label",{style:{"font-size":"16px","margin-right":"5px"}}," 日期： ",-1)),re=n(()=>o("label",{style:{"font-size":"16px","margin-right":"5px"}}," 时间： ",-1)),ue=n(()=>o("label",{style:{"font-size":"14px",color:"#797979","margin-left":"2px"}}," 请设置每日固定时间自动检查库存， 例如设置为08:00，则每天的08:00会自动检查库存并执行补货操作。 ",-1)),de={style:{display:"flex","justify-items":"revert-layer"}},ne=W({__name:"index",setup(g){const S=P(),B=k(()=>{var s;return(s=S.userInfo)==null?void 0:s.userId}),H=k(()=>{var s;return(s=S.userInfo)==null?void 0:s.userName}),h=U(),_=v("fixed"),f=v([]),m=v([]),p=v("08:00"),y=v("08:00"),z={Monday:"monday",Tuesday:"tuesday",Wednesday:"wednesday",Thursday:"thursday",Friday:"friday",Saturday:"saturday",Sunday:"sunday"};async function C(){try{const s=await D();if(s.data){const t=s.data;_.value=t.triggerType==="1"?"fixed":"maxStock";const c=[];t.isTriggerAtLowStock==="1"&&(c.push("reorderPoint"),t.lowStockTime&&(p.value=t.lowStockTime.length>5?t.lowStockTime.substring(0,5):t.lowStockTime)),t.isTriggerByFixtime==="1"&&(c.push("fixedTime"),t.fixtime&&(y.value=t.fixtime.length>5?t.fixtime.substring(0,5):t.fixtime),t.fixedWeek&&t.fixedWeek.length>0&&(f.value=t.fixedWeek.map(x=>z[x]||x.toLowerCase()))),m.value=c}}catch(s){console.error("加载自动申领规则失败:",s),h.error("加载自动申领规则失败")}}F(()=>{C()});async function V(){try{const s={triggerType:_.value==="fixed"?"1":"0",isTriggerAtLowStock:m.value.includes("reorderPoint")?"1":"0",lowStockTime:p.value,isTriggerByFixtime:m.value.includes("fixedTime")?"1":"0",fixtime:y.value,fixedWeek:f.value.map(t=>({monday:"Monday",tuesday:"Tuesday",wednesday:"Wednesday",thursday:"Thursday",friday:"Friday",saturday:"Saturday",sunday:"Sunday"})[t]||t),lastModifiedBy:B.value||"",lastModifiedName:H.value||"",id:""};await L(s),h.success("自动申领补货设置保存成功！"),console.log("自动申领补货设置已保存"),console.log("补货方式:",_.value),console.log("触发规则:",m.value),console.log("再订货点触发时间:",p.value),console.log("固定时间触发时间:",y.value),console.log("选择的日期:",f.value),console.log("请求数据:",s)}catch(s){console.error("保存自动申领规则失败:",s),h.error("保存自动申领规则失败，请重试")}}return(s,t)=>{const c=J,x=R;return b(),T("div",O,[o("div",Q,[e(c,{class:"mr-2"},{default:l(()=>[e(a(E))]),_:1}),X]),o("div",Y,[Z,e(a(G),{value:_.value,"onUpdate:value":t[0]||(t[0]=u=>_.value=u)},{default:l(()=>[e(a(N),{value:"fixed",label:"定量补货"},{default:l(()=>[e(a(r),{class:"ml-2"},{default:l(()=>[i("定量补货")]),_:1})]),_:1}),e(a(N),{value:"maxStock",label:"最大库存量补货"},{default:l(()=>[e(a(r),{class:"ml-2"},{default:l(()=>[i("最大库存量补货")]),_:1})]),_:1})]),_:1},8,["value"]),$]),o("div",ee,[ae,e(a(I),{value:m.value,"onUpdate:value":t[4]||(t[4]=u=>m.value=u),vertical:"",class:"mt-5 ml-5"},{default:l(()=>[e(a(w),{vertical:"",size:16},{default:l(()=>[e(a(d),{value:"reorderPoint",label:"再订货点触发"}),m.value.includes("reorderPoint")?(b(),T("div",te,[le,e(a(A),{"formatted-value":p.value,"onUpdate:formattedValue":t[1]||(t[1]=u=>p.value=u),format:"HH:mm","value-format":"HH:mm",placeholder:"选择触发时间",class:"w-40"},null,8,["formatted-value"]),se])):M("",!0),e(a(d),{value:"fixedTime",label:"固定时间触发"},{default:l(()=>[e(a(r),{class:"ml-2 text-gray-400"},{default:l(()=>[i("每日固定时间自动检查库存")]),_:1})]),_:1}),m.value.includes("fixedTime")?(b(),T("div",oe,[e(a(w),null,{default:l(()=>[ie,e(a(I),{value:f.value,"onUpdate:value":t[2]||(t[2]=u=>f.value=u)},{default:l(()=>[e(a(d),{value:"monday",label:"星期一"},{default:l(()=>[e(a(r),{class:"ml-2 text-gray-400"},{default:l(()=>[i(" 每周一自动检查库存 ")]),_:1})]),_:1}),e(a(d),{value:"tuesday",label:"星期二"},{default:l(()=>[e(a(r),{class:"ml-2 text-gray-400"},{default:l(()=>[i(" 每周二自动检查库存 ")]),_:1})]),_:1}),e(a(d),{value:"wednesday",label:"星期三"},{default:l(()=>[e(a(r),{class:"ml-2 text-gray-400"},{default:l(()=>[i(" 每周三自动检查库存 ")]),_:1})]),_:1}),e(a(d),{value:"thursday",label:"星期四"},{default:l(()=>[e(a(r),{class:"ml-2 text-gray-400"},{default:l(()=>[i(" 每周四自动检查库存 ")]),_:1})]),_:1}),e(a(d),{value:"friday",label:"星期五"},{default:l(()=>[e(a(r),{class:"ml-2 text-gray-400"},{default:l(()=>[i(" 每周五自动检查库存 ")]),_:1})]),_:1}),e(a(d),{value:"saturday",label:"星期六"},{default:l(()=>[e(a(r),{class:"ml-2 text-gray-400"},{default:l(()=>[i(" 每周六自动检查库存 ")]),_:1})]),_:1}),e(a(d),{value:"sunday",label:"星期日"},{default:l(()=>[e(a(r),{class:"ml-2 text-gray-400"},{default:l(()=>[i(" 每周日自动检查库存 ")]),_:1})]),_:1})]),_:1},8,["value"])]),_:1}),e(a(w),{class:"mt-3"},{default:l(()=>[re,e(a(A),{"formatted-value":y.value,"onUpdate:formattedValue":t[3]||(t[3]=u=>y.value=u),format:"HH:mm","value-format":"HH:mm",placeholder:"选择触发时间",class:"w-40"},null,8,["formatted-value"]),ue]),_:1})])):M("",!0)]),_:1})]),_:1},8,["value"])]),o("div",de,[e(x,{type:"primary",class:"w-full",style:{height:"40px",width:"100px"},onClick:V},{default:l(()=>[i(" 确定 ")]),_:1})])])}}});const Ne=K(ne,[["__scopeId","data-v-31a2c373"]]);export{Ne as default};
