import{T as f}from"./table-paginate.js";import{p as k}from"./table-paginate2.js";import{f as x}from"./warning.js";import{N as h}from"./DataTable.js";import{d as b,r as a,o as P,h as l,a7 as S,an as z,ao as N,ap as n,au as p,aw as c}from"./index.js";import{_ as C}from"./_plugin-vue_export-helper.js";import"./format-length.js";import"./Checkbox.js";import"./use-merged-state.js";import"./RadioGroup.js";import"./get-slot.js";import"./Dropdown.js";import"./Input.js";import"./use-compitable.js";import"./FocusDetector.js";import"./next-frame-once.js";import"./get.js";import"./Icon.js";import"./ChevronRight.js";const D={class:"table-area"},E={style:{"margin-bottom":"2px"}},I={class:"mr-2",style:{width:"5rem",color:"#797979"}},B=b({__name:"index",emits:["apply-stock"],setup(w,{emit:u}){const t=a({totalItems:100,pageSize:k,currentPage:1}),m=a({}),d=e=>{t.value.currentPage=e,s()};P(()=>{s()});const r=a(0),i=a(0),y=a([{title:"货柜",key:"cabinet.name"},{title:"耗材子编码",key:"code"},{title:"耗材名称",key:"name"},{title:"规格型号",key:"spec"},{title:"生产厂家",key:"manufacturer"},{title:"数量",key:"number"},{title:"唯一码",key:"rfid"},{title:"批号",key:"batch"},{title:"生产日期",key:"productionDate"},{title:"失效日期",key:"expiryDate"},{title:"近效期天数",key:"nearExpiryDays"},{title:"效期状态",key:"expiryStatus",render:e=>l("span",{nearExpiry:"近效期",expired:"已过期",normal:"正常"}[e.expiryStatus])},{title:"操作",key:"actions",render(e){return l(S,{type:"error",onClick:()=>_(e)},"退库")}}]),o=a([]),s=async()=>{try{const e=await x({page:t.value.currentPage,pagesize:t.value.pageSize,...m.value});e.data&&(o.value=e.data.items,t.value.totalItems=e.data.total,r.value=e.data.expireNum,i.value=e.data.expiredNum),console.log("当前近效期耗材:",r.value)}catch(e){console.error("获取效期预警列表失败:",e),o.value=[],t.value.totalItems=0}};function _(e){u("apply-stock",{type:"management_return",material:e})}return(e,g)=>{const v=h;return z(),N("div",null,[n("div",D,[n("div",E,[n("label",I," 近效期耗材: "+p(r.value)+" 个，已过期耗材："+p(i.value)+" 个 ",1)]),c(v,{columns:y.value,data:o.value},null,8,["columns","data"]),c(f,{total:t.value.totalItems,"page-size":t.value.pageSize,"current-page":t.value.currentPage,onPageChange:d},null,8,["total","page-size","current-page"])])])}}});const Z=C(B,[["__scopeId","data-v-9f4da054"]]);export{Z as default};
