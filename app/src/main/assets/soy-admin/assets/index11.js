import{T as f}from"./table-paginate.js";import{p as h}from"./table-paginate2.js";import{a as x}from"./warning.js";import{d as b,r as a,o as C,h as n,a7 as P,an as S,ao as z,ap as l,au as r,aw as m}from"./index.js";import{N as I}from"./DataTable.js";import{_ as N}from"./_plugin-vue_export-helper.js";import"./format-length.js";import"./Checkbox.js";import"./use-merged-state.js";import"./RadioGroup.js";import"./get-slot.js";import"./Dropdown.js";import"./Input.js";import"./use-compitable.js";import"./FocusDetector.js";import"./next-frame-once.js";import"./get.js";import"./Icon.js";import"./ChevronRight.js";const A={class:"table-area"},B={style:{"margin-bottom":"2px"}},T={class:"mr-2",style:{width:"5rem",color:"#797979"}},D=b({__name:"index",emits:["apply-stock"],setup(M,{emit:d}){const e=a({totalItems:100,pageSize:h,currentPage:1}),_=a({});C(()=>{c()});const s=a(0),i=a(0),y=t=>{e.value.currentPage=t,c()},p=a({applied:{text:"已申领",color:"#67C23A"},unapplied:{text:"未申领",color:"#F56C6C"},normal:{text:"库存正常",color:"#67C23A"}}),v=a([{title:"耗材子编码",key:"code"},{title:"耗材名称",key:"name"},{title:"规格型号",key:"spec"},{title:"品牌",key:"brand"},{title:"生产厂家",key:"manufacturer"},{title:"库存",key:"number"},{title:"库存预警值",key:"safeStockQuantity"},{title:"库存预警",key:"stockAlert",render(t){const u=t.number<=t.safeStockQuantity?t.status?"缺货已申领":n("span",{style:{color:"red"}},"缺货未申领"):"正常";return n("span",u)}},{title:"操作",key:"actions",render(t){return t.status==="unapplied"?n(P,{type:"primary",onClick:()=>g(t)},"申领"):null}},{title:"库存状态",key:"status",render(t){return n("span",{style:{color:p.value[t.status].color}},p.value[t.status].text)}}]),o=a([]),c=async()=>{try{const t=await x({page:e.value.currentPage,pagesize:e.value.pageSize,..._.value});t.data&&(o.value=t.data.items,e.value.totalItems=t.data.total,s.value=t.data.appliedNum,i.value=t.data.unappliedNum)}catch(t){console.error("获取预警列表失败:",t),o.value=[],e.value.totalItems=0}};function g(t){d("apply-stock",{type:"apply",material:t})}return(t,u)=>{const k=I;return S(),z("div",null,[l("div",A,[l("div",B,[l("label",T," 当前耗材库存不足: "+r(o.value.length)+" 种,耗材已申领: "+r(s.value)+" 种,未申领: "+r(i.value)+" 种 ",1)]),l("div",null,[m(k,{columns:v.value,data:o.value},null,8,["columns","data"]),m(f,{total:e.value.totalItems,"page-size":e.value.pageSize,"current-page":e.value.currentPage,onPageChange:y},null,8,["total","page-size","current-page"])])])])}}});const w=N(D,[["__scopeId","data-v-c3052c40"]]);export{w as default};
