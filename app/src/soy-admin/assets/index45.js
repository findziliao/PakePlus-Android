import{d as O,bb as M,b9 as N,r as b,o as F,eb as V,an as C,ao as A,aw as n,ar as l,ap as s,as as B,ax as u,aq as E,aB as R,y as W,ec as P,a$ as $,a7 as q,aC as j,aD as z}from"./index.js";import{S as G}from"./Settings.js";import{N as J}from"./Icon.js";import{_ as K}from"./Input.js";import{_ as Q}from"./FormItem.js";import{_ as X,a as Y}from"./RadioGroup.js";import{_ as Z,a as ee}from"./Checkbox.js";import{_ as te}from"./InputNumber.js";import{_ as ae}from"./TimePicker.js";import{_ as ne}from"./Form.js";import{_ as le}from"./_plugin-vue_export-helper.js";import"./format-length.js";import"./use-merged-state.js";import"./get.js";import"./get-slot.js";import"./Add.js";import"./FocusDetector.js";import"./next-frame-once.js";const r=y=>(j("data-v-d8830a92"),y=y(),z(),y),se={class:"system-setting p-4"},oe={class:"flex items-center"},ie=r(()=>s("h1",{class:"text-xl font-semibold"},"系统设置",-1)),ue={class:"space-y-1"},re={class:"flex gap-8"},me={class:"flex gap-8"},de={class:"flex items-center"},ve=r(()=>s("span",{class:"hint-text ml-3"},"0表示不退出",-1)),pe={class:"flex gap-8"},_e={class:"flex items-center"},fe=r(()=>s("span",{class:"hint-text ml-3"},"0表示不控制轮次",-1)),ce={class:"flex gap-8"},ye={class:"flex items-center"},xe=r(()=>s("span",{class:"hint-text ml-3"},"0表示不控制时长",-1)),ge={class:"flex items-center"},Te=r(()=>s("span",{class:"hint-text ml-3"},"0表示不上报",-1)),be={class:"flex gap-8"},Ce={class:"flex items-center"},Se=r(()=>s("span",{class:"hint-text ml-3"},"0表示不更新",-1)),he={class:"flex items-center"},Ee=r(()=>s("span",{class:"hint-text ml-3"},"0表示不更新",-1)),Re={class:"flex gap-8"},De={class:"flex items-center"},ke=r(()=>s("span",{class:"hint-text ml-3"},"0表示不更新",-1)),we={class:"flex gap-8"},Ie={class:"flex-1"},Le={class:"flex-1"},He={class:"p-4 rounded border border-gray-300 dark:border-gray-600"},Ue=r(()=>s("div",{class:"text-sm mb-3"},"取用归还确认时间设置 - 每日按设定时间更新确认状态",-1)),Oe={class:"flex items-center"},Me=r(()=>s("span",{class:"mr-3"},"更新时间：",-1)),Ne={class:"flex gap-8"},Fe={class:"flex-1"},Ve={class:"p-4 rounded border border-gray-300 dark:border-gray-600"},Ae=r(()=>s("div",{class:"text-sm mb-3"},"重启软件系统设置 - 每日按设定时间重启软件",-1)),Be={class:"flex items-center"},We=r(()=>s("span",{class:"mr-3"},"重启时间：",-1)),Pe={class:"pt-6 flex justify-end"},$e=O({__name:"index",setup(y){const S=M(),D=N(),x=b(),h=b(!0),_=b(!1),e=b({systemName:"",systemApplicationScene:"高值柜",systemLoginMethods:[],noOperationExitLoginWaitTime:0,systemExitLoginDisplayPage:"登录页",inventoryCountingMethod:"RFID",inventoryCountingCycle:0,inventoryCountingTime:0,reportCabinetDataInterval:0,previousDayTakeConfirm:!0,isEnableScheduledRestart:!1,restartTime:"00:00",dictionaryTime:"00:00",dictionaryInterval:0,ExpiryStatusTime:"00:00",consumeRecord:0,pendingTime:0,takeOrReturnConfirmTime:"00:00"}),k=()=>{h.value&&!_.value&&(_.value=!0,W(()=>{x.value&&x.value.blur&&x.value.blur(),h.value=!1,_.value=!1}))},w=()=>{_.value&&(_.value=!1)};F(async()=>{var d,a,p,f;try{const o=await V();console.log("获取系统设置列表成功:",o),o.data&&(e.value={systemName:o.data.systemName||"",systemApplicationScene:o.data.systemApplicationScene||"高值柜",systemLoginMethods:o.data.systemLoginMethods||[],noOperationExitLoginWaitTime:o.data.noOperationExitLoginWaitTime,systemExitLoginDisplayPage:o.data.systemExitLoginDisplayPage||"登录页",inventoryCountingMethod:o.data.inventoryCountingMethod||"RFID",inventoryCountingCycle:o.data.inventoryCountingCycle,inventoryCountingTime:o.data.inventoryCountingTime,reportCabinetDataInterval:o.data.reportCabinetDataInterval,previousDayTakeConfirm:o.data.previousDayTakeConfirm,isEnableScheduledRestart:!!o.data.isEnableScheduledRestart,restartTime:((d=o.data.restartTime)==null?void 0:d.substring(0,5))||null,dictionaryTime:((a=o.data.dictionaryTime)==null?void 0:a.substring(0,5))||null,dictionaryInterval:o.data.dictionaryInterval,ExpiryStatusTime:((p=o.data.ExpiryStatusTime)==null?void 0:p.substring(0,5))||null,consumeRecord:o.data.consumeRecord||0,pendingTime:o.data.pendingTime||0,takeOrReturnConfirmTime:((f=o.data.takeOrReturnConfirmTime)==null?void 0:f.substring(0,5))||null})}catch(o){console.log("获取系统设置列表失败:",o)}});const I=async()=>{try{const d={systemName:e.value.systemName,systemApplicationScene:e.value.systemApplicationScene,systemLoginMethods:e.value.systemLoginMethods,noOperationExitLoginWaitTime:e.value.noOperationExitLoginWaitTime,systemExitLoginDisplayPage:e.value.systemExitLoginDisplayPage,inventoryCountingMethod:e.value.inventoryCountingMethod,inventoryCountingCycle:e.value.inventoryCountingCycle,inventoryCountingTime:e.value.inventoryCountingTime,reportCabinetDataInterval:e.value.reportCabinetDataInterval,previousDayTakeConfirm:e.value.previousDayTakeConfirm,isEnableScheduledRestart:e.value.isEnableScheduledRestart,restartTime:e.value.restartTime?e.value.restartTime:null,dictionaryTime:e.value.dictionaryTime,ExpiryStatusTime:e.value.ExpiryStatusTime?e.value.ExpiryStatusTime:null,consumeRecord:e.value.consumeRecord,pendingTime:e.value.pendingTime,takeOrReturnConfirmTime:e.value.takeOrReturnConfirmTime?e.value.takeOrReturnConfirmTime:null},{data:a,error:p}=await P(d);if(p){S.error("修改系统设置失败,错误信息:"+a);return}S.success("修改系统设置成功"),await D.initSystemSettings()}catch(d){console.error("更新系统设置失败:",d)}};return(d,a)=>{const p=J,f=$,o=K,i=Q,m=X,c=Y,g=Z,L=ee,v=te,T=ae,H=q,U=ne;return C(),A("div",se,[n(f,null,{default:l(()=>[s("div",oe,[n(p,{class:"mr-1",size:"23"},{default:l(()=>[n(B(G))]),_:1}),ie])]),_:1}),n(f,null,{default:l(()=>[n(U,{model:e.value,"label-placement":"left","label-width":"230","label-style":{marginRight:"30px"},"label-align":"left",class:"px-16"},{default:l(()=>[s("div",ue,[s("div",re,[n(i,{label:"系统名称",class:"flex-1"},{default:l(()=>[n(o,{ref_key:"firstInputRef",ref:x,value:e.value.systemName,"onUpdate:value":a[0]||(a[0]=t=>e.value.systemName=t),placeholder:"请输入系统名称",class:"w-full",style:{width:"180px"},onFocus:k,onBlur:w},null,8,["value"])]),_:1}),n(i,{label:"系统应用场景",class:"flex-1"},{default:l(()=>[n(c,{value:e.value.systemApplicationScene,"onUpdate:value":a[1]||(a[1]=t=>e.value.systemApplicationScene=t)},{default:l(()=>[n(m,{value:"highValueCabinet"},{default:l(()=>[u("高值柜")]),_:1}),n(m,{value:"lowValueCabinet"},{default:l(()=>[u("低值柜")]),_:1}),n(m,{value:"consumableHouse"},{default:l(()=>[u("耗材屋")]),_:1})]),_:1},8,["value"])]),_:1})]),n(i,{label:"系统其他登录方式"},{default:l(()=>[n(L,{value:e.value.systemLoginMethods,"onUpdate:value":a[2]||(a[2]=t=>e.value.systemLoginMethods=t)},{default:l(()=>[n(g,{value:"face"},{default:l(()=>[u("人脸识别")]),_:1}),n(g,{value:"vein"},{default:l(()=>[u("指静脉登录")]),_:1}),n(g,{value:"nfc"},{default:l(()=>[u("NFC登录")]),_:1}),n(g,{value:"finger"},{default:l(()=>[u("指纹登录")]),_:1})]),_:1},8,["value"])]),_:1}),s("div",me,[n(i,{label:"无操作时退出登录等待时长（秒）",class:"flex-1"},{default:l(()=>[s("div",de,[n(v,{value:e.value.noOperationExitLoginWaitTime,"onUpdate:value":[a[3]||(a[3]=t=>e.value.noOperationExitLoginWaitTime=t),a[4]||(a[4]=t=>{t===null||t<0?e.value.noOperationExitLoginWaitTime=0:t>10800&&(e.value.noOperationExitLoginWaitTime=10800)})],min:0,max:10800,step:1,class:"w-full max-w-[180px]"},null,8,["value"]),ve])]),_:1}),n(i,{label:"系统退出登录后显示页",class:"flex-1"},{default:l(()=>[n(c,{value:e.value.systemExitLoginDisplayPage,"onUpdate:value":a[5]||(a[5]=t=>e.value.systemExitLoginDisplayPage=t)},{default:l(()=>[n(m,{value:"loginpage"},{default:l(()=>[u("登录页")]),_:1}),n(m,{value:"homepage"},{default:l(()=>[u("首页")]),_:1})]),_:1},8,["value"])]),_:1})]),s("div",pe,[n(i,{label:"盘点方式",class:"flex-1"},{default:l(()=>[n(c,{value:e.value.inventoryCountingMethod,"onUpdate:value":a[6]||(a[6]=t=>e.value.inventoryCountingMethod=t)},{default:l(()=>[n(m,{value:"RFID"},{default:l(()=>[u("RFID")]),_:1}),n(m,{value:"scanner"},{default:l(()=>[u("扫码枪")]),_:1})]),_:1},8,["value"])]),_:1}),n(i,{label:"库存盘点轮次",class:"flex-1"},{default:l(()=>[s("div",_e,[n(v,{value:e.value.inventoryCountingCycle,"onUpdate:value":[a[7]||(a[7]=t=>e.value.inventoryCountingCycle=t),a[8]||(a[8]=t=>{t!==null&&t>10&&(e.value.inventoryCountingCycle=10)})],min:0,max:10,step:1,class:"w-full max-w-[180px]"},null,8,["value"]),fe])]),_:1})]),s("div",ce,[n(i,{label:"库存盘点时长(秒)",class:"flex-1"},{default:l(()=>[s("div",ye,[n(v,{value:e.value.inventoryCountingTime,"onUpdate:value":[a[9]||(a[9]=t=>e.value.inventoryCountingTime=t),a[10]||(a[10]=t=>{t!==null&&t>100&&(e.value.inventoryCountingTime=100)})],min:0,max:100,step:1,class:"w-full max-w-[180px]"},null,8,["value"]),xe])]),_:1}),n(i,{label:"上报数据间隔（分钟）",class:"flex-1"},{default:l(()=>[s("div",ge,[n(v,{value:e.value.reportCabinetDataInterval,"onUpdate:value":[a[11]||(a[11]=t=>e.value.reportCabinetDataInterval=t),a[12]||(a[12]=t=>{t!==null&&t>10080&&(e.value.reportCabinetDataInterval=10080)})],min:0,max:10080,step:1,class:"w-full max-w-[180px]"},null,8,["value"]),Te])]),_:1})]),s("div",be,[n(i,{label:"更新待上架单间隔（分钟）",class:"flex-1"},{default:l(()=>[s("div",Ce,[n(v,{value:e.value.pendingTime,"onUpdate:value":[a[13]||(a[13]=t=>e.value.pendingTime=t),a[14]||(a[14]=t=>{t===null||t<0?e.value.pendingTime=0:t>10080&&(e.value.pendingTime=10080)})],min:0,max:10080,step:1,class:"w-full max-w-[180px]"},null,8,["value"]),Se])]),_:1}),n(i,{label:"更新商品消耗记录间隔（分钟）",class:"flex-1"},{default:l(()=>[s("div",he,[n(v,{value:e.value.consumeRecord,"onUpdate:value":[a[15]||(a[15]=t=>e.value.consumeRecord=t),a[16]||(a[16]=t=>{t===null||t<0?e.value.consumeRecord=0:t>10080&&(e.value.consumeRecord=10080)})],min:0,max:10080,step:1,class:"w-full max-w-[180px]"},null,8,["value"]),Ee])]),_:1})]),s("div",Re,[n(i,{label:"全量更新字典时间",class:"flex-1"},{default:l(()=>[n(T,{"formatted-value":e.value.dictionaryTime,"onUpdate:formattedValue":a[17]||(a[17]=t=>e.value.dictionaryTime=t),format:"HH:mm","value-format":"HH:mm",class:"w-[160px]"},null,8,["formatted-value"])]),_:1}),n(i,{label:"更新字典间隔（分钟）",class:"flex-1"},{default:l(()=>[s("div",De,[n(v,{value:e.value.dictionaryInterval,"onUpdate:value":[a[18]||(a[18]=t=>e.value.dictionaryInterval=t),a[19]||(a[19]=t=>{t===null||t<0?e.value.dictionaryInterval=0:t>10080&&(e.value.dictionaryInterval=10080)})],min:0,max:10080,step:1,class:"w-full max-w-[180px]"},null,8,["value"]),ke])]),_:1})]),s("div",we,[s("div",Ie,[n(i,{label:"更新耗材效期状态时间设置",class:"flex-1"},{default:l(()=>[n(T,{"formatted-value":e.value.ExpiryStatusTime,"onUpdate:formattedValue":a[20]||(a[20]=t=>e.value.ExpiryStatusTime=t),format:"HH:mm","value-format":"HH:mm",class:"w-[160px]"},null,8,["formatted-value"])]),_:1})]),s("div",Le,[n(i,{label:"前一日取货签字确认"},{default:l(()=>[n(c,{value:e.value.previousDayTakeConfirm,"onUpdate:value":a[21]||(a[21]=t=>e.value.previousDayTakeConfirm=t)},{default:l(()=>[n(m,{value:!0},{default:l(()=>[u("启用")]),_:1}),n(m,{value:!1},{default:l(()=>[u("停用")]),_:1})]),_:1},8,["value"])]),_:1}),e.value.previousDayTakeConfirm?(C(),E(i,{key:0,label:""},{default:l(()=>[s("div",He,[Ue,s("div",Oe,[Me,n(T,{"formatted-value":e.value.takeOrReturnConfirmTime,"onUpdate:formattedValue":a[22]||(a[22]=t=>e.value.takeOrReturnConfirmTime=t),format:"HH:mm","value-format":"HH:mm",class:"w-[160px]"},null,8,["formatted-value"])])])]),_:1})):R("",!0)])]),s("div",Ne,[s("div",Fe,[n(i,{label:"是否开启定时重启"},{default:l(()=>[n(c,{value:e.value.isEnableScheduledRestart,"onUpdate:value":a[23]||(a[23]=t=>e.value.isEnableScheduledRestart=t)},{default:l(()=>[n(m,{value:!0},{default:l(()=>[u("是")]),_:1}),n(m,{value:!1},{default:l(()=>[u("否")]),_:1})]),_:1},8,["value"])]),_:1}),e.value.isEnableScheduledRestart?(C(),E(i,{key:0,label:""},{default:l(()=>[s("div",Ve,[Ae,s("div",Be,[We,n(T,{"formatted-value":e.value.restartTime,"onUpdate:formattedValue":a[24]||(a[24]=t=>e.value.restartTime=t),format:"HH:mm","value-format":"HH:mm",class:"w-[160px]"},null,8,["formatted-value"])])])]),_:1})):R("",!0)])]),s("div",Pe,[n(H,{type:"primary",onClick:I,class:"w-[120px]"},{default:l(()=>[u("保存")]),_:1})])])]),_:1},8,["model"])]),_:1})])}}});const ut=le($e,[["__scopeId","data-v-d8830a92"]]);export{ut as default};
